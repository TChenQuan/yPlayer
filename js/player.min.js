"use strict";Vue.config.debug=!0;var vm=new Vue({el:"#ym-player",data:{song_name:"",album_name:"",artist_name:"",showlrc:[],musicArray:"",playingMusic:"",playingIndex:"",havevoice:!0,playStatus:!0,prevIndex:"",prevMusic:"",followIndex:"",followMusic:"",curtime:"00:00",musictime:"00:00",loaded:!1},created:function(){this.loadMusic()},methods:{getJSON:function(t){var s=new Promise(function(s,e){function i(){4===this.readyState&&(200===this.status?s(this.response):e(new Error(this.statusText)))}var r=new XMLHttpRequest;r.open("GET",t),r.onreadystatechange=i,r.responseType="json",r.setRequestHeader("Accept","application/json"),r.send()});return s},changePlay:function(){0==this.playStatus?(this.playStatus=!0,this.$els.mplayer.play()):(this.playStatus=!1,this.$els.mplayer.pause())},loadMusic:function(t){var s=t?"getSong.php?id="+t:"getSong.php?id=0";this.getJSON(s).then(function(t){vm.musicArray=t.tracks,vm.musicLength=vm.musicArray.length,vm.$els.album.style.backgroundImage="url("+t.cover+")","no"!=t.lrc?vm.showlrc=t.lrc:vm.showlrc={0:"暂无歌词"},vm.song_name=t.music_name,vm.album_name=t.album_name,vm.artist_name=t.artists,vm.playingMusic=t.id,vm.playingIndex=t.index,vm.loaded=!0,vm.$els.mplayer.setAttribute("src",t.mp3),vm.$els.mplayer.volumn=.5,vm.$els.mplayer.play()},function(t){alert("服务器通信异常")})},changeVoice:function(t){this.$els.mplayer.volume=t.target.value/10,0==t.target.value?this.havevoice=!1:this.havevoice=!0},nextMusic:function(){var t,s;this.followMusic&&this.followIndex?(t=this.followIndex,s=this.followMusic):(t=Math.ceil(Math.random()*this.musicLength),s=this.musicArray[t].id),this.followIndex="",this.followMusic="",this.prevMusic=this.playingMusic,this.prevIndex=this.playingIndex,this.showlrc=[],this.getJSON("getLyrics.php?id="+s).then(function(t){"no"!=t.lrc?vm.showlrc=t.lrc:vm.showlrc={0:"暂无歌词"}},function(t){alert("服务器通信异常")});var e="";for(var i in this.musicArray[t].artists)e+=this.musicArray[t].artists[i].name;this.$els.album.style.backgroundImage="url("+this.musicArray[t].album.picUrl+")",this.playingMusic=this.musicArray[t].id,this.playingIndex=t,this.song_name=this.musicArray[t].name,this.album_name=this.musicArray[t].album.name,this.artist_name=e;var r=this.musicArray[t].mp3Url;this.$els.mplayer.setAttribute("src",r),this.$els.mplayer.volumn=.5,this.$els.mplayer.play(),this.playStatus=!0},backMusic:function(){if(!this.prevMusic||!this.prevIndex)return!1;this.followIndex=this.playingIndex,this.followMusic=this.playingMusic,this.showlrc=[],this.getJSON("getLyrics.php?id="+this.prevMusic).then(function(t){"no"!=t.lrc?vm.showlrc=t.lrc:vm.showlrc={0:"暂无歌词"}},function(t){alert("服务器通信异常")});var t="";for(var s in this.musicArray[this.prevIndex].artists)t+=this.musicArray[this.prevIndex].artists[s].name;this.$els.album.style.backgroundImage="url("+this.musicArray[this.prevIndex].album.picUrl+")",this.playingMusic=this.musicArray[this.prevIndex].id,this.playingIndex=this.prevIndex,this.song_name=this.musicArray[this.prevIndex].name,this.album_name=this.musicArray[this.prevIndex].album.name,this.artist_name=t;var e=this.musicArray[this.prevIndex].mp3Url;this.prevMusic="",this.prevIndex="",this.$els.mplayer.setAttribute("src",e),this.$els.mplayer.volumn=.5,this.$els.mplayer.play(),this.playStatus=!0},getMusic:function(){var t=void 0,s=void 0,e=parseInt(this.$els.mplayer.duration/60);s=e.toString().length>1?""+e:"0"+e;var i=parseInt(this.$els.mplayer.duration%60);t=i.toString().length>1?""+i:"0"+i,this.musictime=s+":"+t},playEvent:function(){var t=void 0,s=void 0,e=parseInt(this.$els.mplayer.currentTime/60);s=e.toString().length>1?""+e:"0"+e;var i=parseInt(this.$els.mplayer.currentTime%60);t=i.toString().length>1?""+i:"0"+i,this.curtime=s+":"+t;var r=Math.floor(this.$els.mplayer.currentTime).toString();this.display_lrc(r);var a=this.$els.mplayer.buffered.end(0)/this.$els.mplayer.duration,l=this.$els.mplayer.currentTime/this.$els.mplayer.duration;this.$els.buffer.style.transform="scaleX("+a+")",this.$els.playtime.style.transform="scaleX("+l+")"},changeProgress:function(t){var s=t.clientX-this.$els.progress.getBoundingClientRect().left;this.$els.mplayer.currentTime=parseInt(s/240*this.$els.mplayer.duration)},display_lrc:function(t){for(var s=document.getElementsByClassName("lrc"),e=0;e<s.length;e++)e+1<s.length&&(s[e].getAttribute("dtime")<=this.$els.mplayer.currentTime&&this.$els.mplayer.currentTime<s[e+1].getAttribute("dtime")?(s[e].classList?s[e].classList.add("lrc-current"):s[e].className+=" lrc-current",s[e].offsetTop>200&&(this.$els.lyricbox.scrollTop=s[e].offsetTop-200)):s[e].classList?s[e].classList.remove("lrc-current"):s[e].className=s[e].className.replace(new RegExp("(^|\\b)"+"lrc-current".split(" ").join("|")+"(\\b|$)","gi")," "));s[s.length-1].getAttribute("dtime")<=this.$els.mplayer.currentTime&&(s[s.length-1].classList?s[s.length-1].classList.add("lrc-current"):s[s.length-1].className+=" lrc-current")}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBsYXllci5qcyJdLCJuYW1lcyI6WyJWdWUiLCJjb25maWciLCJkZWJ1ZyIsInZtIiwiZWwiLCJkYXRhIiwic29uZ19uYW1lIiwiYWxidW1fbmFtZSIsImFydGlzdF9uYW1lIiwic2hvd2xyYyIsIm11c2ljQXJyYXkiLCJwbGF5aW5nTXVzaWMiLCJwbGF5aW5nSW5kZXgiLCJoYXZldm9pY2UiLCJwbGF5U3RhdHVzIiwicHJldkluZGV4IiwicHJldk11c2ljIiwiZm9sbG93SW5kZXgiLCJmb2xsb3dNdXNpYyIsImN1cnRpbWUiLCJtdXNpY3RpbWUiLCJsb2FkZWQiLCJjcmVhdGVkIiwidGhpcyIsImxvYWRNdXNpYyIsIm1ldGhvZHMiLCJnZXRKU09OIiwidXJsIiwicHJvbWlzZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiaGFuZGxlciIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJyZXNwb25zZSIsIkVycm9yIiwic3RhdHVzVGV4dCIsImNsaWVudCIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlc3BvbnNlVHlwZSIsInNldFJlcXVlc3RIZWFkZXIiLCJzZW5kIiwiY2hhbmdlUGxheSIsIiRlbHMiLCJtcGxheWVyIiwicGxheSIsInBhdXNlIiwiaWQiLCJ0aGVuIiwidHJhY2tzIiwibXVzaWNMZW5ndGgiLCJsZW5ndGgiLCJhbGJ1bSIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwiY292ZXIiLCJscmMiLCIwIiwibXVzaWNfbmFtZSIsImFydGlzdHMiLCJpbmRleCIsInNldEF0dHJpYnV0ZSIsIm1wMyIsInZvbHVtbiIsImVycm9yIiwiYWxlcnQiLCJjaGFuZ2VWb2ljZSIsImV2ZW50Iiwidm9sdW1lIiwidGFyZ2V0IiwidmFsdWUiLCJuZXh0TXVzaWMiLCJyYW5kb21faW5kZXgiLCJyYW5kb21faWQiLCJNYXRoIiwiY2VpbCIsInJhbmRvbSIsImFydGlzdHNfbmFtZSIsImkiLCJuYW1lIiwicGljVXJsIiwibXAzX2FkZHJlc3MiLCJtcDNVcmwiLCJiYWNrTXVzaWMiLCJnZXRNdXNpYyIsIm1fc2Vjb25kIiwidW5kZWZpbmVkIiwibV9taW51dGUiLCJ0ZW1wX21pbnV0ZSIsInBhcnNlSW50IiwiZHVyYXRpb24iLCJ0b1N0cmluZyIsInRlbXBfc2Vjb25kIiwicGxheUV2ZW50IiwiY19zZWNvbmQiLCJjX21pbnV0ZSIsImN1cnJlbnRUaW1lIiwicGxheV90aW1lIiwiZmxvb3IiLCJkaXNwbGF5X2xyYyIsImJ1ZmZlcl9wZXJjZW50IiwiYnVmZmVyZWQiLCJlbmQiLCJjdXJyZW50X3BlcmNlbnQiLCJidWZmZXIiLCJ0cmFuc2Zvcm0iLCJwbGF5dGltZSIsImNoYW5nZVByb2dyZXNzIiwicHJvZ3Jlc3NYIiwiY2xpZW50WCIsInByb2dyZXNzIiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwibGVmdCIsImxyY3MiLCJkb2N1bWVudCIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJnZXRBdHRyaWJ1dGUiLCJjbGFzc0xpc3QiLCJhZGQiLCJjbGFzc05hbWUiLCJvZmZzZXRUb3AiLCJseXJpY2JveCIsInNjcm9sbFRvcCIsInJlbW92ZSIsInJlcGxhY2UiLCJSZWdFeHAiLCJzcGxpdCIsImpvaW4iXSwibWFwcGluZ3MiOiJBQUlBLFlBRUFBLEtBQUlDLE9BQU9DLE9BQVEsQ0FDbkIsSUFBSUMsSUFBSyxHQUFJSCxNQUNYSSxHQUFJLGFBQ0pDLE1BQ0VDLFVBQVcsR0FDWEMsV0FBWSxHQUNaQyxZQUFhLEdBQ2JDLFdBQ0FDLFdBQVksR0FDWkMsYUFBYyxHQUNkQyxhQUFjLEdBQ2RDLFdBQVcsRUFDWEMsWUFBWSxFQUNaQyxVQUFXLEdBQ1hDLFVBQVcsR0FDWEMsWUFBYSxHQUNiQyxZQUFhLEdBQ2JDLFFBQVMsUUFDVEMsVUFBVyxRQUNYQyxRQUFRLEdBRVZDLFFBQVMsV0FDUEMsS0FBS0MsYUFFUEMsU0FDRUMsUUFBUyxTQUFpQkMsR0FDeEIsR0FBSUMsR0FBVSxHQUFJQyxTQUFRLFNBQVVDLEVBQVNDLEdBTTdC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QUs5RCxPQUFTLEdBQUdrRSxVQUN4QkosRUFBS0EsRUFBSzlELE9BQVMsR0FBR2tFLFVBQVVDLElBQUksZUFFcENMLEVBQUtBLEVBQUs5RCxPQUFTLEdBQUdvRSxXQUFhIiwiZmlsZSI6InBsYXllci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuKiB5UGxheWVyXG4qIEF1dGhvciB5YW5nemoxOTkyXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cblZ1ZS5jb25maWcuZGVidWcgPSB0cnVlO1xudmFyIHZtID0gbmV3IFZ1ZSh7XG4gIGVsOiAnI3ltLXBsYXllcicsXG4gIGRhdGE6IHtcbiAgICBzb25nX25hbWU6ICcnLFxuICAgIGFsYnVtX25hbWU6ICcnLFxuICAgIGFydGlzdF9uYW1lOiAnJyxcbiAgICBzaG93bHJjOiBbXSxcbiAgICBtdXNpY0FycmF5OiAnJyxcbiAgICBwbGF5aW5nTXVzaWM6ICcnLFxuICAgIHBsYXlpbmdJbmRleDogJycsXG4gICAgaGF2ZXZvaWNlOiB0cnVlLFxuICAgIHBsYXlTdGF0dXM6IHRydWUsXG4gICAgcHJldkluZGV4OiAnJyxcbiAgICBwcmV2TXVzaWM6ICcnLFxuICAgIGZvbGxvd0luZGV4OiAnJyxcbiAgICBmb2xsb3dNdXNpYzogJycsXG4gICAgY3VydGltZTogJzAwOjAwJyxcbiAgICBtdXNpY3RpbWU6ICcwMDowMCcsXG4gICAgbG9hZGVkOiBmYWxzZVxuICB9LFxuICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkge1xuICAgIHRoaXMubG9hZE11c2ljKCk7XG4gIH0sXG4gIG1ldGhvZHM6IHtcbiAgICBnZXRKU09OOiBmdW5jdGlvbiBnZXRKU09OKHVybCkge1xuICAgICAgdmFyIHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICAgIHZhciBjbGllbnQgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgY2xpZW50Lm9wZW4oXCJHRVRcIiwgdXJsKTtcbiAgICAgICAgY2xpZW50Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGhhbmRsZXI7XG4gICAgICAgIGNsaWVudC5yZXNwb25zZVR5cGUgPSBcImpzb25cIjtcbiAgICAgICAgY2xpZW50LnNldFJlcXVlc3RIZWFkZXIoXCJBY2NlcHRcIiwgXCJhcHBsaWNhdGlvbi9qc29uXCIpO1xuICAgICAgICBjbGllbnQuc2VuZCgpO2Z1bmN0aW9uIGhhbmRsZXIoKSB7XG4gICAgICAgICAgaWYgKHRoaXMucmVhZHlTdGF0ZSAhPT0gNCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1pZiAodGhpcy5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLnJlc3BvbnNlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcih0aGlzLnN0YXR1c1RleHQpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBwcm9taXNlO1xuICAgIH0sXG4gICAgY2hhbmdlUGxheTogZnVuY3Rpb24gY2hhbmdlUGxheSgpIHtcbiAgICAgIGlmICh0aGlzLnBsYXlTdGF0dXMgPT0gZmFsc2UpIHtcbiAgICAgICAgdGhpcy5wbGF5U3RhdHVzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIucGxheSgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5wbGF5U3RhdHVzID0gZmFsc2U7XG4gICAgICAgIHRoaXMuJGVscy5tcGxheWVyLnBhdXNlKCk7XG4gICAgICB9XG4gICAgfSxcbiAgICBsb2FkTXVzaWM6IGZ1bmN0aW9uIGxvYWRNdXNpYyhpZCkge1xuICAgICAgdmFyIHVybCA9IGlkID8gJ2dldFNvbmcucGhwP2lkPScgKyBpZCA6ICdnZXRTb25nLnBocD9pZD0wJztcbiAgICAgIHRoaXMuZ2V0SlNPTih1cmwpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdm0ubXVzaWNBcnJheSA9IGRhdGEudHJhY2tzO1xuICAgICAgICB2bS5tdXNpY0xlbmd0aCA9IHZtLm11c2ljQXJyYXkubGVuZ3RoO1xuICAgICAgICB2bS4kZWxzLmFsYnVtLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9ICd1cmwoJyArIGRhdGEuY292ZXIgKyAnKSc7XG4gICAgICAgIGlmIChkYXRhLmxyYyAhPSBcIm5vXCIpIHtcbiAgICAgICAgICB2bS5zaG93bHJjID0gZGF0YS5scmM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdm0uc2hvd2xyYyA9IHsgXCIwXCI6IFwi5pqC5peg5q2M6K+NXCIgfTtcbiAgICAgICAgfVxuICAgICAgICB2bS5zb25nX25hbWUgPSBkYXRhLm11c2ljX25hbWU7XG4gICAgICAgIHZtLmFsYnVtX25hbWUgPSBkYXRhLmFsYnVtX25hbWU7XG4gICAgICAgIHZtLmFydGlzdF9uYW1lID0gZGF0YS5hcnRpc3RzO1xuICAgICAgICB2bS5wbGF5aW5nTXVzaWMgPSBkYXRhLmlkO1xuICAgICAgICB2bS5wbGF5aW5nSW5kZXggPSBkYXRhLmluZGV4O1xuICAgICAgICB2bS5sb2FkZWQgPSB0cnVlO1xuICAgICAgICB2bS4kZWxzLm1wbGF5ZXIuc2V0QXR0cmlidXRlKFwic3JjXCIsIGRhdGEubXAzKTtcbiAgICAgICAgdm0uJGVscy5tcGxheWVyLnZvbHVtbiA9IDAuNTtcbiAgICAgICAgdm0uJGVscy5tcGxheWVyLnBsYXkoKTtcbiAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBhbGVydCgn5pyN5Yqh5Zmo6YCa5L+h5byC5bi4Jyk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGNoYW5nZVZvaWNlOiBmdW5jdGlvbiBjaGFuZ2VWb2ljZShldmVudCkge1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIudm9sdW1lID0gZXZlbnQudGFyZ2V0LnZhbHVlIC8gMTA7XG4gICAgICBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlID09IDApIHtcbiAgICAgICAgdGhpcy5oYXZldm9pY2UgPSBmYWxzZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuaGF2ZXZvaWNlID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIG5leHRNdXNpYzogZnVuY3Rpb24gbmV4dE11c2ljKCkge1xuICAgICAgdmFyIHJhbmRvbV9pbmRleDtcbiAgICAgIHZhciByYW5kb21faWQ7XG4gICAgICBpZiAoIXRoaXMuZm9sbG93TXVzaWMgfHwgIXRoaXMuZm9sbG93SW5kZXgpIHtcbiAgICAgICAgcmFuZG9tX2luZGV4ID0gTWF0aC5jZWlsKE1hdGgucmFuZG9tKCkgKiB0aGlzLm11c2ljTGVuZ3RoKTtcbiAgICAgICAgcmFuZG9tX2lkID0gdGhpcy5tdXNpY0FycmF5W3JhbmRvbV9pbmRleF0uaWQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByYW5kb21faW5kZXggPSB0aGlzLmZvbGxvd0luZGV4O1xuICAgICAgICByYW5kb21faWQgPSB0aGlzLmZvbGxvd011c2ljO1xuICAgICAgfVxuICAgICAgdGhpcy5mb2xsb3dJbmRleCA9ICcnO1xuICAgICAgdGhpcy5mb2xsb3dNdXNpYyA9ICcnO1xuICAgICAgdGhpcy5wcmV2TXVzaWMgPSB0aGlzLnBsYXlpbmdNdXNpYztcbiAgICAgIHRoaXMucHJldkluZGV4ID0gdGhpcy5wbGF5aW5nSW5kZXg7XG4gICAgICB0aGlzLnNob3dscmMgPSBbXTtcbiAgICAgIHRoaXMuZ2V0SlNPTignZ2V0THlyaWNzLnBocD9pZD0nICsgcmFuZG9tX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGlmIChkYXRhLmxyYyAhPSBcIm5vXCIpIHtcbiAgICAgICAgICB2bS5zaG93bHJjID0gZGF0YS5scmM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdm0uc2hvd2xyYyA9IHsgXCIwXCI6IFwi5pqC5peg5q2M6K+NXCIgfTtcbiAgICAgICAgfVxuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGFsZXJ0KCfmnI3liqHlmajpgJrkv6HlvILluLgnKTtcbiAgICAgIH0pO1xuICAgICAgdmFyIGFydGlzdHNfbmFtZSA9ICcnO1xuICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5hcnRpc3RzKSB7XG4gICAgICAgIGFydGlzdHNfbmFtZSArPSB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5hcnRpc3RzW2ldLm5hbWU7XG4gICAgICB9XG4gICAgICB0aGlzLiRlbHMuYWxidW0uc3R5bGUuYmFja2dyb3VuZEltYWdlID0gJ3VybCgnICsgdGhpcy5tdXNpY0FycmF5W3JhbmRvbV9pbmRleF0uYWxidW0ucGljVXJsICsgJyknO1xuICAgICAgdGhpcy5wbGF5aW5nTXVzaWMgPSB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5pZDtcbiAgICAgIHRoaXMucGxheWluZ0luZGV4ID0gcmFuZG9tX2luZGV4O1xuICAgICAgdGhpcy5zb25nX25hbWUgPSB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5uYW1lO1xuICAgICAgdGhpcy5hbGJ1bV9uYW1lID0gdGhpcy5tdXNpY0FycmF5W3JhbmRvbV9pbmRleF0uYWxidW0ubmFtZTtcbiAgICAgIHRoaXMuYXJ0aXN0X25hbWUgPSBhcnRpc3RzX25hbWU7XG4gICAgICB2YXIgbXAzX2FkZHJlc3MgPSB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5tcDNVcmw7XG4gICAgICB0aGlzLiRlbHMubXBsYXllci5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgbXAzX2FkZHJlc3MpO1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIudm9sdW1uID0gMC41O1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIucGxheSgpO1xuICAgICAgdGhpcy5wbGF5U3RhdHVzID0gdHJ1ZTtcbiAgICB9LFxuICAgIGJhY2tNdXNpYzogZnVuY3Rpb24gYmFja011c2ljKCkge1xuICAgICAgaWYgKCF0aGlzLnByZXZNdXNpYyB8fCAhdGhpcy5wcmV2SW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdGhpcy5mb2xsb3dJbmRleCA9IHRoaXMucGxheWluZ0luZGV4O1xuICAgICAgdGhpcy5mb2xsb3dNdXNpYyA9IHRoaXMucGxheWluZ011c2ljO1xuICAgICAgdGhpcy5zaG93bHJjID0gW107XG4gICAgICB0aGlzLmdldEpTT04oJ2dldEx5cmljcy5waHA/aWQ9JyArIHRoaXMucHJldk11c2ljKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGlmIChkYXRhLmxyYyAhPSBcIm5vXCIpIHtcbiAgICAgICAgICB2bS5zaG93bHJjID0gZGF0YS5scmM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdm0uc2hvd2xyYyA9IHsgXCIwXCI6IFwi5pqC5peg5q2M6K+NXCIgfTtcbiAgICAgICAgfVxuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGFsZXJ0KCfmnI3liqHlmajpgJrkv6HlvILluLgnKTtcbiAgICAgIH0pO1xuICAgICAgdmFyIGFydGlzdHNfbmFtZSA9ICcnO1xuICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLm11c2ljQXJyYXlbdGhpcy5wcmV2SW5kZXhdLmFydGlzdHMpIHtcbiAgICAgICAgYXJ0aXN0c19uYW1lICs9IHRoaXMubXVzaWNBcnJheVt0aGlzLnByZXZJbmRleF0uYXJ0aXN0c1tpXS5uYW1lO1xuICAgICAgfVxuICAgICAgdGhpcy4kZWxzLmFsYnVtLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9ICd1cmwoJyArIHRoaXMubXVzaWNBcnJheVt0aGlzLnByZXZJbmRleF0uYWxidW0ucGljVXJsICsgJyknO1xuICAgICAgdGhpcy5wbGF5aW5nTXVzaWMgPSB0aGlzLm11c2ljQXJyYXlbdGhpcy5wcmV2SW5kZXhdLmlkO1xuICAgICAgdGhpcy5wbGF5aW5nSW5kZXggPSB0aGlzLnByZXZJbmRleDtcbiAgICAgIHRoaXMuc29uZ19uYW1lID0gdGhpcy5tdXNpY0FycmF5W3RoaXMucHJldkluZGV4XS5uYW1lO1xuICAgICAgdGhpcy5hbGJ1bV9uYW1lID0gdGhpcy5tdXNpY0FycmF5W3RoaXMucHJldkluZGV4XS5hbGJ1bS5uYW1lO1xuICAgICAgdGhpcy5hcnRpc3RfbmFtZSA9IGFydGlzdHNfbmFtZTtcbiAgICAgIHZhciBtcDNfYWRkcmVzcyA9IHRoaXMubXVzaWNBcnJheVt0aGlzLnByZXZJbmRleF0ubXAzVXJsO1xuICAgICAgdGhpcy5wcmV2TXVzaWMgPSAnJztcbiAgICAgIHRoaXMucHJldkluZGV4ID0gJyc7XG4gICAgICB0aGlzLiRlbHMubXBsYXllci5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgbXAzX2FkZHJlc3MpO1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIudm9sdW1uID0gMC41O1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIucGxheSgpO1xuICAgICAgdGhpcy5wbGF5U3RhdHVzID0gdHJ1ZTtcbiAgICB9LFxuICAgIGdldE11c2ljOiBmdW5jdGlvbiBnZXRNdXNpYygpIHtcbiAgICAgIHZhciBtX3NlY29uZCA9IHVuZGVmaW5lZCxcbiAgICAgICAgICBtX21pbnV0ZSA9IHVuZGVmaW5lZDtcbiAgICAgIHZhciB0ZW1wX21pbnV0ZSA9IHBhcnNlSW50KHRoaXMuJGVscy5tcGxheWVyLmR1cmF0aW9uIC8gNjApO1xuICAgICAgaWYgKHRlbXBfbWludXRlLnRvU3RyaW5nKCkubGVuZ3RoID4gMSkge1xuICAgICAgICBtX21pbnV0ZSA9ICcnICsgdGVtcF9taW51dGU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtX21pbnV0ZSA9ICcwJyArIHRlbXBfbWludXRlO1xuICAgICAgfVxuICAgICAgdmFyIHRlbXBfc2Vjb25kID0gcGFyc2VJbnQodGhpcy4kZWxzLm1wbGF5ZXIuZHVyYXRpb24gJSA2MCk7XG4gICAgICBpZiAodGVtcF9zZWNvbmQudG9TdHJpbmcoKS5sZW5ndGggPiAxKSB7XG4gICAgICAgIG1fc2Vjb25kID0gJycgKyB0ZW1wX3NlY29uZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1fc2Vjb25kID0gJzAnICsgdGVtcF9zZWNvbmQ7XG4gICAgICB9XG4gICAgICB0aGlzLm11c2ljdGltZSA9IG1fbWludXRlICsgJzonICsgbV9zZWNvbmQ7XG4gICAgfSxcbiAgICBwbGF5RXZlbnQ6IGZ1bmN0aW9uIHBsYXlFdmVudCgpIHtcbiAgICAgIHZhciBjX3NlY29uZCA9IHVuZGVmaW5lZCxcbiAgICAgICAgICBjX21pbnV0ZSA9IHVuZGVmaW5lZDtcbiAgICAgIHZhciB0ZW1wX21pbnV0ZSA9IHBhcnNlSW50KHRoaXMuJGVscy5tcGxheWVyLmN1cnJlbnRUaW1lIC8gNjApO1xuICAgICAgaWYgKHRlbXBfbWludXRlLnRvU3RyaW5nKCkubGVuZ3RoID4gMSkge1xuICAgICAgICBjX21pbnV0ZSA9ICcnICsgdGVtcF9taW51dGU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjX21pbnV0ZSA9ICcwJyArIHRlbXBfbWludXRlO1xuICAgICAgfVxuICAgICAgdmFyIHRlbXBfc2Vjb25kID0gcGFyc2VJbnQodGhpcy4kZWxzLm1wbGF5ZXIuY3VycmVudFRpbWUgJSA2MCk7XG4gICAgICBpZiAodGVtcF9zZWNvbmQudG9TdHJpbmcoKS5sZW5ndGggPiAxKSB7XG4gICAgICAgIGNfc2Vjb25kID0gJycgKyB0ZW1wX3NlY29uZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNfc2Vjb25kID0gJzAnICsgdGVtcF9zZWNvbmQ7XG4gICAgICB9XG4gICAgICB0aGlzLmN1cnRpbWUgPSBjX21pbnV0ZSArICc6JyArIGNfc2Vjb25kO1xuICAgICAgdmFyIHBsYXlfdGltZSA9IE1hdGguZmxvb3IodGhpcy4kZWxzLm1wbGF5ZXIuY3VycmVudFRpbWUpLnRvU3RyaW5nKCk7XG4gICAgICB0aGlzLmRpc3BsYXlfbHJjKHBsYXlfdGltZSk7XG4gICAgICB2YXIgYnVmZmVyX3BlcmNlbnQgPSB0aGlzLiRlbHMubXBsYXllci5idWZmZXJlZC5lbmQoMCkgLyB0aGlzLiRlbHMubXBsYXllci5kdXJhdGlvbjtcbiAgICAgIHZhciBjdXJyZW50X3BlcmNlbnQgPSB0aGlzLiRlbHMubXBsYXllci5jdXJyZW50VGltZSAvIHRoaXMuJGVscy5tcGxheWVyLmR1cmF0aW9uO1xuICAgICAgdGhpcy4kZWxzLmJ1ZmZlci5zdHlsZS50cmFuc2Zvcm0gPSBcInNjYWxlWChcIiArIGJ1ZmZlcl9wZXJjZW50ICsgXCIpXCI7XG4gICAgICB0aGlzLiRlbHMucGxheXRpbWUuc3R5bGUudHJhbnNmb3JtID0gXCJzY2FsZVgoXCIgKyBjdXJyZW50X3BlcmNlbnQgKyBcIilcIjtcbiAgICB9LFxuICAgIGNoYW5nZVByb2dyZXNzOiBmdW5jdGlvbiBjaGFuZ2VQcm9ncmVzcyhldmVudCkge1xuICAgICAgdmFyIHByb2dyZXNzWCA9IGV2ZW50LmNsaWVudFggLSB0aGlzLiRlbHMucHJvZ3Jlc3MuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDtcbiAgICAgIHRoaXMuJGVscy5tcGxheWVyLmN1cnJlbnRUaW1lID0gcGFyc2VJbnQocHJvZ3Jlc3NYIC8gMjQwICogdGhpcy4kZWxzLm1wbGF5ZXIuZHVyYXRpb24pO1xuICAgIH0sXG4gICAgZGlzcGxheV9scmM6IGZ1bmN0aW9uIGRpc3BsYXlfbHJjKHBsYXlfdGltZSkge1xuICAgICAgdmFyIGxyY3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdscmMnKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbHJjcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoaSArIDEgPCBscmNzLmxlbmd0aCkge1xuICAgICAgICAgIGlmIChscmNzW2ldLmdldEF0dHJpYnV0ZSgnZHRpbWUnKSA8PSB0aGlzLiRlbHMubXBsYXllci5jdXJyZW50VGltZSAmJiB0aGlzLiRlbHMubXBsYXllci5jdXJyZW50VGltZSA8IGxyY3NbaSArIDFdLmdldEF0dHJpYnV0ZSgnZHRpbWUnKSkge1xuICAgICAgICAgICAgaWYgKGxyY3NbaV0uY2xhc3NMaXN0KSB7XG4gICAgICAgICAgICAgIGxyY3NbaV0uY2xhc3NMaXN0LmFkZCgnbHJjLWN1cnJlbnQnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGxyY3NbaV0uY2xhc3NOYW1lICs9ICcgJyArICdscmMtY3VycmVudCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobHJjc1tpXS5vZmZzZXRUb3AgPiAyMDApIHtcbiAgICAgICAgICAgICAgdGhpcy4kZWxzLmx5cmljYm94LnNjcm9sbFRvcCA9IGxyY3NbaV0ub2Zmc2V0VG9wIC0gMjAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAobHJjc1tpXS5jbGFzc0xpc3QpIHtcbiAgICAgICAgICAgICAgbHJjc1tpXS5jbGFzc0xpc3QucmVtb3ZlKCdscmMtY3VycmVudCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbHJjc1tpXS5jbGFzc05hbWUgPSBscmNzW2ldLmNsYXNzTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoJyhefFxcXFxiKScgKyAnbHJjLWN1cnJlbnQnLnNwbGl0KCcgJykuam9pbignfCcpICsgJyhcXFxcYnwkKScsICdnaScpLCAnICcpOyAvL2llOFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGxyY3NbbHJjcy5sZW5ndGggLSAxXS5nZXRBdHRyaWJ1dGUoJ2R0aW1lJykgPD0gdGhpcy4kZWxzLm1wbGF5ZXIuY3VycmVudFRpbWUpIHtcbiAgICAgICAgaWYgKGxyY3NbbHJjcy5sZW5ndGggLSAxXS5jbGFzc0xpc3QpIHtcbiAgICAgICAgICBscmNzW2xyY3MubGVuZ3RoIC0gMV0uY2xhc3NMaXN0LmFkZCgnbHJjLWN1cnJlbnQnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBscmNzW2xyY3MubGVuZ3RoIC0gMV0uY2xhc3NOYW1lICs9ICcgJyArICdscmMtY3VycmVudCc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
