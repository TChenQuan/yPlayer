"use strict";Vue.config.debug=!0;var vm=new Vue({el:"#ym-player",data:{song_name:"",album_name:"",artist_name:"",showlrc:[],musicArray:"",playingMusic:"",playingIndex:"",havevoice:!0,playStatus:!0,prevIndex:"",prevMusic:"",followIndex:"",followMusic:"",volume:.5,curtime:"00:00",musictime:"00:00",loaded:!1},created:function(){this.loadMusic()},methods:{getJSON:function(e){var t=new Promise(function(t,s){function i(){4===this.readyState&&(200===this.status?t(this.response):s(new Error(this.statusText)))}var r=new XMLHttpRequest;r.open("GET",e),r.onreadystatechange=i,r.responseType="json",r.setRequestHeader("Accept","application/json"),r.send()});return t},changePlay:function(){0==this.playStatus?(this.playStatus=!0,this.$els.mplayer.play()):(this.playStatus=!1,this.$els.mplayer.pause())},loadMusic:function(e){var t=e?"getSong.php?id="+e:"getSong.php?id=0";this.getJSON(t).then(function(e){vm.musicArray=e.tracks,vm.musicLength=vm.musicArray.length,vm.$els.album.style.backgroundImage="url("+e.cover+")","no"!=e.lrc?vm.showlrc=e.lrc:vm.showlrc={0:"暂无歌词"},vm.song_name=e.music_name,vm.album_name=e.album_name,vm.artist_name=e.artists,vm.playingMusic=e.id,vm.playingIndex=e.index,vm.loaded=!0,vm.$els.mplayer.setAttribute("src",e.mp3),vm.$els.mplayer.volume=.5,vm.$els.mplayer.play()},function(e){alert("服务器通信异常")})},changeVoice:function(e){this.$els.mplayer.volume=e.target.value/10,0==e.target.value?this.havevoice=!1:(this.havevoice=!0,this.volume=e.target.value)},changeSound:function(){1==this.havevoice?(this.havevoice=!1,this.$els.mplayer.volume=0,this.$els.soundrange.value=0):(this.havevoice=!0,this.$els.mplayer.volume=this.volume/10,this.$els.soundrange.value=this.volume)},checkStatus:function(){return 0==this.$els.mplayer.buffered.length?!1:!0},nextMusic:function(){var e,t;this.followMusic&&this.followIndex?(e=this.followIndex,t=this.followMusic):(e=Math.ceil(Math.random()*this.musicLength),t=this.musicArray[e].id),this.followIndex="",this.followMusic="",this.prevMusic=this.playingMusic,this.prevIndex=this.playingIndex,this.showlrc=[],this.getJSON("getLyrics.php?id="+t).then(function(e){"no"!=e.lrc?vm.showlrc=e.lrc:vm.showlrc={0:"暂无歌词"}},function(e){alert("服务器通信异常")});var s="";for(var i in this.musicArray[e].artists)s+=this.musicArray[e].artists[i].name;this.$els.album.style.backgroundImage="url("+this.musicArray[e].album.picUrl+")",this.playingMusic=this.musicArray[e].id,this.playingIndex=e,this.song_name=this.musicArray[e].name,this.album_name=this.musicArray[e].album.name,this.artist_name=s;var r=this.musicArray[e].mp3Url;this.$els.mplayer.setAttribute("src",r),this.$els.mplayer.volume=.5,this.$els.mplayer.play(),this.playStatus=!0},backMusic:function(){if(!this.prevMusic||!this.prevIndex)return!1;this.followIndex=this.playingIndex,this.followMusic=this.playingMusic,this.showlrc=[],this.getJSON("getLyrics.php?id="+this.prevMusic).then(function(e){"no"!=e.lrc?vm.showlrc=e.lrc:vm.showlrc={0:"暂无歌词"}},function(e){alert("服务器通信异常")});var e="";for(var t in this.musicArray[this.prevIndex].artists)e+=this.musicArray[this.prevIndex].artists[t].name;this.$els.album.style.backgroundImage="url("+this.musicArray[this.prevIndex].album.picUrl+")",this.playingMusic=this.musicArray[this.prevIndex].id,this.playingIndex=this.prevIndex,this.song_name=this.musicArray[this.prevIndex].name,this.album_name=this.musicArray[this.prevIndex].album.name,this.artist_name=e;var s=this.musicArray[this.prevIndex].mp3Url;this.prevMusic="",this.prevIndex="",this.$els.mplayer.setAttribute("src",s),this.$els.mplayer.volume=.5,this.$els.mplayer.play(),this.playStatus=!0},getMusic:function(){var e=void 0,t=void 0,s=parseInt(this.$els.mplayer.duration/60);t=s.toString().length>1?""+s:"0"+s;var i=parseInt(this.$els.mplayer.duration%60);e=i.toString().length>1?""+i:"0"+i,this.musictime=t+":"+e},playEvent:function(){if(!this.checkStatus())return!1;var e=void 0,t=void 0,s=parseInt(this.$els.mplayer.currentTime/60);t=s.toString().length>1?""+s:"0"+s;var i=parseInt(this.$els.mplayer.currentTime%60);e=i.toString().length>1?""+i:"0"+i,this.curtime=t+":"+e;var r=Math.floor(this.$els.mplayer.currentTime).toString();this.display_lrc(r);var a=this.$els.mplayer.buffered.end(0)/this.$els.mplayer.duration,l=this.$els.mplayer.currentTime/this.$els.mplayer.duration;this.$els.buffer.style.transform="scaleX("+a+")",this.$els.playtime.style.transform="scaleX("+l+")"},changeProgress:function(e){if(!this.checkStatus())return!1;var t=e.clientX-this.$els.progress.getBoundingClientRect().left;this.$els.mplayer.currentTime=parseInt(t/240*this.$els.mplayer.duration)},display_lrc:function(e){if(!this.checkStatus())return!1;for(var t=document.getElementsByClassName("lrc"),s=0;s<t.length;s++)s+1<t.length&&(t[s].getAttribute("dtime")<=this.$els.mplayer.currentTime&&this.$els.mplayer.currentTime<t[s+1].getAttribute("dtime")?(t[s].classList?t[s].classList.add("lrc-current"):t[s].className+=" lrc-current",t[s].offsetTop>200&&(this.$els.lyricbox.scrollTop=t[s].offsetTop-200)):t[s].classList?t[s].classList.remove("lrc-current"):t[s].className=t[s].className.replace(new RegExp("(^|\\b)"+"lrc-current".split(" ").join("|")+"(\\b|$)","gi")," "));t[t.length-1].getAttribute("dtime")<=this.$els.mplayer.currentTime&&(t[t.length-1].classList?t[t.length-1].classList.add("lrc-current"):t[t.length-1].className+=" lrc-current")}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBsYXllci5qcyJdLCJuYW1lcyI6WyJWdWUiLCJjb25maWciLCJkZWJ1ZyIsInZtIiwiZWwiLCJkYXRhIiwic29uZ19uYW1lIiwiYWxidW1fbmFtZSIsImFydGlzdF9uYW1lIiwic2hvd2xyYyIsIm11c2ljQXJyYXkiLCJwbGF5aW5nTXVzaWMiLCJwbGF5aW5nSW5kZXgiLCJoYXZldm9pY2UiLCJwbGF5U3RhdHVzIiwicHJldkluZGV4IiwicHJldk11c2ljIiwiZm9sbG93SW5kZXgiLCJmb2xsb3dNdXNpYyIsInZvbHVtZSIsImN1cnRpbWUiLCJtdXNpY3RpbWUiLCJsb2FkZWQiLCJjcmVhdGVkIiwidGhpcyIsImxvYWRNdXNpYyIsIm1ldGhvZHMiLCJnZXRKU09OIiwidXJsIiwicHJvbWlzZSIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiaGFuZGxlciIsInJlYWR5U3RhdGUiLCJzdGF0dXMiLCJyZXNwb25zZSIsIkVycm9yIiwic3RhdHVzVGV4dCIsImNsaWVudCIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlc3BvbnNlVHlwZSIsInNldFJlcXVlc3RIZWFkZXIiLCJzZW5kIiwiY2hhbmdlUGxheSIsIiRlbHMiLCJtcGxheWVyIiwicGxheSIsInBhdXNlIiwiaWQiLCJ0aGVuIiwidHJhY2tzIiwibXVzaWNMZW5ndGgiLCJsZW5ndGgiLCJhbGJ1bSIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwiY292ZXIiLCJscmMiLCIwIiwibXVzaWNfbmFtZSIsImFydGlzdHMiLCJpbmRleCIsInNldEF0dHJpYnV0ZSIsIm1wMyIsImVycm9yIiwiYWxlcnQiLCJjaGFuZ2VWb2ljZSIsImV2ZW50IiwidGFyZ2V0IiwidmFsdWUiLCJjaGFuZ2VTb3VuZCIsInNvdW5kcmFuZ2UiLCJjaGVja1N0YXR1cyIsImJ1ZmZlcmVkIiwibmV4dE11c2ljIiwicmFuZG9tX2luZGV4IiwicmFuZG9tX2lkIiwiTWF0aCIsImNlaWwiLCJyYW5kb20iLCJhcnRpc3RzX25hbWUiLCJpIiwibmFtZSIsInBpY1VybCIsIm1wM19hZGRyZXNzIiwibXAzVXJsIiwiYmFja011c2ljIiwiZ2V0TXVzaWMiLCJtX3NlY29uZCIsInVuZGVmaW5lZCIsIm1fbWludXRlIiwidGVtcF9taW51dGUiLCJwYXJzZUludCIsImR1cmF0aW9uIiwidG9TdHJpbmciLCJ0ZW1wX3NlY29uZCIsInBsYXlFdmVudCIsImNfc2Vjb25kIiwiY19taW51dGUiLCJjdXJyZW50VGltZSIsInBsYXlfdGltZSIsImZsb29yIiwiZGlzcGxheV9scmMiLCJidWZmZXJfcGVyY2VudCIsImVuZCIsImN1cnJlbnRfcGVyY2VudCIsImJ1ZmZlciIsInRyYW5zZm9ybSIsInBsYXl0aW1lIiwiY2hhbmdlUHJvZ3Jlc3MiLCJwcm9ncmVzc1giLCJjbGllbnRYIiwicHJvZ3Jlc3MiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJsZWZ0IiwibHJjcyIsImRvY3VtZW50IiwiZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSIsImdldEF0dHJpYnV0ZSIsImNsYXNzTGlzdCIsImFkZCIsImNsYXNzTmFtZSIsIm9mZnNldFRvcCIsImx5cmljYm94Iiwic2Nyb2xsVG9wIiwicmVtb3ZlIiwicmVwbGFjZSIsIlJlZ0V4cCIsInNwbGl0Iiwiam9pbiJdLCJtYXBwaW5ncyI6IkFBSUEsWUFFQUEsS0FBSUMsT0FBT0MsT0FBUSxDQUNuQixJQUFJQyxJQUFLLEdBQUlILE1BQ1hJLEdBQUksYUFDSkMsTUFDRUMsVUFBVyxHQUNYQyxXQUFZLEdBQ1pDLFlBQWEsR0FDYkMsV0FDQUMsV0FBWSxHQUNaQyxhQUFjLEdBQ2RDLGFBQWMsR0FDZEMsV0FBVyxFQUNYQyxZQUFZLEVBQ1pDLFVBQVcsR0FDWEMsVUFBVyxHQUNYQyxZQUFhLEdBQ2JDLFlBQWEsR0FDYkMsT0FBUSxHQUNSQyxRQUFTLFFBQ1RDLFVBQVcsUUFDWEMsUUFBUSxHQUVWQyxRQUFTLFdBQ1BDLEtBQUtDLGFBRVBDLFNBQ0VDLFFBQVMsU0FBaUJDLEdB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ZTlFLEtBQUt1QixLQUFLQyxRQUFRc0QsWUFBY2dCLEVBQUtsQyxFQUFJLEdBQUdxQyxhQUFhLFVBQ3pISCxFQUFLbEMsR0FBR3NDLFVBQ1ZKLEVBQUtsQyxHQUFHc0MsVUFBVUMsSUFBSSxlQUV0QkwsRUFBS2xDLEdBQUd3QyxXQUFhLGVBRW5CTixFQUFLbEMsR0FBR3lDLFVBQVksTUFDdEJyRyxLQUFLdUIsS0FBSytFLFNBQVNDLFVBQVlULEVBQUtsQyxHQUFHeUMsVUFBWSxNQUdqRFAsRUFBS2xDLEdBQUdzQyxVQUNWSixFQUFLbEMsR0FBR3NDLFVBQVVNLE9BQU8sZUFFekJWLEVBQUtsQyxHQUFHd0MsVUFBWU4sRUFBS2xDLEdBQUd3QyxVQUFVSyxRQUFRLEdBQUlDLFFBQU8sVUFBWSxjQUFjQyxNQUFNLEtBQUtDLEtBQUssS0FBTyxVQUFXLE1BQU8sS0FLaElkLEdBQUtBLEVBQUsvRCxPQUFTLEdBQUdrRSxhQUFhLFVBQVlqRyxLQUFLdUIsS0FBS0MsUUFBUXNELGNBQy9EZ0IsRUFBS0EsRUFBSy9ELE9BQVMsR0FBR21FLFVBQ3hCSixFQUFLQSxFQUFLL0QsT0FBUyxHQUFHbUUsVUFBVUMsSUFBSSxlQUVwQ0wsRUFBS0EsRUFBSy9ELE9BQVMsR0FBR3FFLFdBQWEiLCJmaWxlIjoicGxheWVyLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4qIHlQbGF5ZXJcbiogQXV0aG9yIHlhbmd6ajE5OTJcbiovXG5cInVzZSBzdHJpY3RcIjtcblxuVnVlLmNvbmZpZy5kZWJ1ZyA9IHRydWU7XG52YXIgdm0gPSBuZXcgVnVlKHtcbiAgZWw6ICcjeW0tcGxheWVyJyxcbiAgZGF0YToge1xuICAgIHNvbmdfbmFtZTogJycsXG4gICAgYWxidW1fbmFtZTogJycsXG4gICAgYXJ0aXN0X25hbWU6ICcnLFxuICAgIHNob3dscmM6IFtdLFxuICAgIG11c2ljQXJyYXk6ICcnLFxuICAgIHBsYXlpbmdNdXNpYzogJycsXG4gICAgcGxheWluZ0luZGV4OiAnJyxcbiAgICBoYXZldm9pY2U6IHRydWUsXG4gICAgcGxheVN0YXR1czogdHJ1ZSxcbiAgICBwcmV2SW5kZXg6ICcnLFxuICAgIHByZXZNdXNpYzogJycsXG4gICAgZm9sbG93SW5kZXg6ICcnLFxuICAgIGZvbGxvd011c2ljOiAnJyxcbiAgICB2b2x1bWU6IDAuNSxcbiAgICBjdXJ0aW1lOiAnMDA6MDAnLFxuICAgIG11c2ljdGltZTogJzAwOjAwJyxcbiAgICBsb2FkZWQ6IGZhbHNlXG4gIH0sXG4gIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7XG4gICAgdGhpcy5sb2FkTXVzaWMoKTtcbiAgfSxcbiAgbWV0aG9kczoge1xuICAgIGdldEpTT046IGZ1bmN0aW9uIGdldEpTT04odXJsKSB7XG4gICAgICB2YXIgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgICAgdmFyIGNsaWVudCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICBjbGllbnQub3BlbihcIkdFVFwiLCB1cmwpO1xuICAgICAgICBjbGllbnQub25yZWFkeXN0YXRlY2hhbmdlID0gaGFuZGxlcjtcbiAgICAgICAgY2xpZW50LnJlc3BvbnNlVHlwZSA9IFwianNvblwiO1xuICAgICAgICBjbGllbnQuc2V0UmVxdWVzdEhlYWRlcihcIkFjY2VwdFwiLCBcImFwcGxpY2F0aW9uL2pzb25cIik7XG4gICAgICAgIGNsaWVudC5zZW5kKCk7ZnVuY3Rpb24gaGFuZGxlcigpIHtcbiAgICAgICAgICBpZiAodGhpcy5yZWFkeVN0YXRlICE9PSA0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfWlmICh0aGlzLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICByZXNvbHZlKHRoaXMucmVzcG9uc2UpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKHRoaXMuc3RhdHVzVGV4dCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHByb21pc2U7XG4gICAgfSxcbiAgICBjaGFuZ2VQbGF5OiBmdW5jdGlvbiBjaGFuZ2VQbGF5KCkge1xuICAgICAgaWYgKHRoaXMucGxheVN0YXR1cyA9PSBmYWxzZSkge1xuICAgICAgICB0aGlzLnBsYXlTdGF0dXMgPSB0cnVlO1xuICAgICAgICB0aGlzLiRlbHMubXBsYXllci5wbGF5KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnBsYXlTdGF0dXMgPSBmYWxzZTtcbiAgICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIucGF1c2UoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGxvYWRNdXNpYzogZnVuY3Rpb24gbG9hZE11c2ljKGlkKSB7XG4gICAgICB2YXIgdXJsID0gaWQgPyAnZ2V0U29uZy5waHA/aWQ9JyArIGlkIDogJ2dldFNvbmcucGhwP2lkPTAnO1xuICAgICAgdGhpcy5nZXRKU09OKHVybCkudGhlbihmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICB2bS5tdXNpY0FycmF5ID0gZGF0YS50cmFja3M7XG4gICAgICAgIHZtLm11c2ljTGVuZ3RoID0gdm0ubXVzaWNBcnJheS5sZW5ndGg7XG4gICAgICAgIHZtLiRlbHMuYWxidW0uc3R5bGUuYmFja2dyb3VuZEltYWdlID0gJ3VybCgnICsgZGF0YS5jb3ZlciArICcpJztcbiAgICAgICAgaWYgKGRhdGEubHJjICE9IFwibm9cIikge1xuICAgICAgICAgIHZtLnNob3dscmMgPSBkYXRhLmxyYztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2bS5zaG93bHJjID0geyBcIjBcIjogXCLmmoLml6DmrYzor41cIiB9O1xuICAgICAgICB9XG4gICAgICAgIHZtLnNvbmdfbmFtZSA9IGRhdGEubXVzaWNfbmFtZTtcbiAgICAgICAgdm0uYWxidW1fbmFtZSA9IGRhdGEuYWxidW1fbmFtZTtcbiAgICAgICAgdm0uYXJ0aXN0X25hbWUgPSBkYXRhLmFydGlzdHM7XG4gICAgICAgIHZtLnBsYXlpbmdNdXNpYyA9IGRhdGEuaWQ7XG4gICAgICAgIHZtLnBsYXlpbmdJbmRleCA9IGRhdGEuaW5kZXg7XG4gICAgICAgIHZtLmxvYWRlZCA9IHRydWU7XG4gICAgICAgIHZtLiRlbHMubXBsYXllci5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgZGF0YS5tcDMpO1xuICAgICAgICB2bS4kZWxzLm1wbGF5ZXIudm9sdW1lID0gMC41O1xuICAgICAgICB2bS4kZWxzLm1wbGF5ZXIucGxheSgpO1xuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGFsZXJ0KCfmnI3liqHlmajpgJrkv6HlvILluLgnKTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgY2hhbmdlVm9pY2U6IGZ1bmN0aW9uIGNoYW5nZVZvaWNlKGV2ZW50KSB7XG4gICAgICB0aGlzLiRlbHMubXBsYXllci52b2x1bWUgPSBldmVudC50YXJnZXQudmFsdWUgLyAxMDtcbiAgICAgIGlmIChldmVudC50YXJnZXQudmFsdWUgPT0gMCkge1xuICAgICAgICB0aGlzLmhhdmV2b2ljZSA9IGZhbHNlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5oYXZldm9pY2UgPSB0cnVlO1xuICAgICAgICB0aGlzLnZvbHVtZSA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGNoYW5nZVNvdW5kOiBmdW5jdGlvbiBjaGFuZ2VTb3VuZCgpIHtcbiAgICAgIGlmICh0aGlzLmhhdmV2b2ljZSA9PSB0cnVlKSB7XG4gICAgICAgIHRoaXMuaGF2ZXZvaWNlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuJGVscy5tcGxheWVyLnZvbHVtZSA9IDA7XG4gICAgICAgIHRoaXMuJGVscy5zb3VuZHJhbmdlLnZhbHVlID0gMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuaGF2ZXZvaWNlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIudm9sdW1lID0gdGhpcy52b2x1bWUgLyAxMDtcbiAgICAgICAgdGhpcy4kZWxzLnNvdW5kcmFuZ2UudmFsdWUgPSB0aGlzLnZvbHVtZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGNoZWNrU3RhdHVzOiBmdW5jdGlvbiBjaGVja1N0YXR1cygpIHtcbiAgICAgIGlmICh0aGlzLiRlbHMubXBsYXllci5idWZmZXJlZC5sZW5ndGggPT0gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIG5leHRNdXNpYzogZnVuY3Rpb24gbmV4dE11c2ljKCkge1xuICAgICAgdmFyIHJhbmRvbV9pbmRleDtcbiAgICAgIHZhciByYW5kb21faWQ7XG4gICAgICBpZiAoIXRoaXMuZm9sbG93TXVzaWMgfHwgIXRoaXMuZm9sbG93SW5kZXgpIHtcbiAgICAgICAgcmFuZG9tX2luZGV4ID0gTWF0aC5jZWlsKE1hdGgucmFuZG9tKCkgKiB0aGlzLm11c2ljTGVuZ3RoKTtcbiAgICAgICAgcmFuZG9tX2lkID0gdGhpcy5tdXNpY0FycmF5W3JhbmRvbV9pbmRleF0uaWQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByYW5kb21faW5kZXggPSB0aGlzLmZvbGxvd0luZGV4O1xuICAgICAgICByYW5kb21faWQgPSB0aGlzLmZvbGxvd011c2ljO1xuICAgICAgfVxuICAgICAgdGhpcy5mb2xsb3dJbmRleCA9ICcnO1xuICAgICAgdGhpcy5mb2xsb3dNdXNpYyA9ICcnO1xuICAgICAgdGhpcy5wcmV2TXVzaWMgPSB0aGlzLnBsYXlpbmdNdXNpYztcbiAgICAgIHRoaXMucHJldkluZGV4ID0gdGhpcy5wbGF5aW5nSW5kZXg7XG4gICAgICB0aGlzLnNob3dscmMgPSBbXTtcbiAgICAgIHRoaXMuZ2V0SlNPTignZ2V0THlyaWNzLnBocD9pZD0nICsgcmFuZG9tX2lkKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGlmIChkYXRhLmxyYyAhPSBcIm5vXCIpIHtcbiAgICAgICAgICB2bS5zaG93bHJjID0gZGF0YS5scmM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdm0uc2hvd2xyYyA9IHsgXCIwXCI6IFwi5pqC5peg5q2M6K+NXCIgfTtcbiAgICAgICAgfVxuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGFsZXJ0KCfmnI3liqHlmajpgJrkv6HlvILluLgnKTtcbiAgICAgIH0pO1xuICAgICAgdmFyIGFydGlzdHNfbmFtZSA9ICcnO1xuICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5hcnRpc3RzKSB7XG4gICAgICAgIGFydGlzdHNfbmFtZSArPSB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5hcnRpc3RzW2ldLm5hbWU7XG4gICAgICB9XG4gICAgICB0aGlzLiRlbHMuYWxidW0uc3R5bGUuYmFja2dyb3VuZEltYWdlID0gJ3VybCgnICsgdGhpcy5tdXNpY0FycmF5W3JhbmRvbV9pbmRleF0uYWxidW0ucGljVXJsICsgJyknO1xuICAgICAgdGhpcy5wbGF5aW5nTXVzaWMgPSB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5pZDtcbiAgICAgIHRoaXMucGxheWluZ0luZGV4ID0gcmFuZG9tX2luZGV4O1xuICAgICAgdGhpcy5zb25nX25hbWUgPSB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5uYW1lO1xuICAgICAgdGhpcy5hbGJ1bV9uYW1lID0gdGhpcy5tdXNpY0FycmF5W3JhbmRvbV9pbmRleF0uYWxidW0ubmFtZTtcbiAgICAgIHRoaXMuYXJ0aXN0X25hbWUgPSBhcnRpc3RzX25hbWU7XG4gICAgICB2YXIgbXAzX2FkZHJlc3MgPSB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5tcDNVcmw7XG4gICAgICB0aGlzLiRlbHMubXBsYXllci5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgbXAzX2FkZHJlc3MpO1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIudm9sdW1lID0gMC41O1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIucGxheSgpO1xuICAgICAgdGhpcy5wbGF5U3RhdHVzID0gdHJ1ZTtcbiAgICB9LFxuICAgIGJhY2tNdXNpYzogZnVuY3Rpb24gYmFja011c2ljKCkge1xuICAgICAgaWYgKCF0aGlzLnByZXZNdXNpYyB8fCAhdGhpcy5wcmV2SW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdGhpcy5mb2xsb3dJbmRleCA9IHRoaXMucGxheWluZ0luZGV4O1xuICAgICAgdGhpcy5mb2xsb3dNdXNpYyA9IHRoaXMucGxheWluZ011c2ljO1xuICAgICAgdGhpcy5zaG93bHJjID0gW107XG4gICAgICB0aGlzLmdldEpTT04oJ2dldEx5cmljcy5waHA/aWQ9JyArIHRoaXMucHJldk11c2ljKS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7XG4gICAgICAgIGlmIChkYXRhLmxyYyAhPSBcIm5vXCIpIHtcbiAgICAgICAgICB2bS5zaG93bHJjID0gZGF0YS5scmM7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdm0uc2hvd2xyYyA9IHsgXCIwXCI6IFwi5pqC5peg5q2M6K+NXCIgfTtcbiAgICAgICAgfVxuICAgICAgfSwgZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgIGFsZXJ0KCfmnI3liqHlmajpgJrkv6HlvILluLgnKTtcbiAgICAgIH0pO1xuICAgICAgdmFyIGFydGlzdHNfbmFtZSA9ICcnO1xuICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLm11c2ljQXJyYXlbdGhpcy5wcmV2SW5kZXhdLmFydGlzdHMpIHtcbiAgICAgICAgYXJ0aXN0c19uYW1lICs9IHRoaXMubXVzaWNBcnJheVt0aGlzLnByZXZJbmRleF0uYXJ0aXN0c1tpXS5uYW1lO1xuICAgICAgfVxuICAgICAgdGhpcy4kZWxzLmFsYnVtLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9ICd1cmwoJyArIHRoaXMubXVzaWNBcnJheVt0aGlzLnByZXZJbmRleF0uYWxidW0ucGljVXJsICsgJyknO1xuICAgICAgdGhpcy5wbGF5aW5nTXVzaWMgPSB0aGlzLm11c2ljQXJyYXlbdGhpcy5wcmV2SW5kZXhdLmlkO1xuICAgICAgdGhpcy5wbGF5aW5nSW5kZXggPSB0aGlzLnByZXZJbmRleDtcbiAgICAgIHRoaXMuc29uZ19uYW1lID0gdGhpcy5tdXNpY0FycmF5W3RoaXMucHJldkluZGV4XS5uYW1lO1xuICAgICAgdGhpcy5hbGJ1bV9uYW1lID0gdGhpcy5tdXNpY0FycmF5W3RoaXMucHJldkluZGV4XS5hbGJ1bS5uYW1lO1xuICAgICAgdGhpcy5hcnRpc3RfbmFtZSA9IGFydGlzdHNfbmFtZTtcbiAgICAgIHZhciBtcDNfYWRkcmVzcyA9IHRoaXMubXVzaWNBcnJheVt0aGlzLnByZXZJbmRleF0ubXAzVXJsO1xuICAgICAgdGhpcy5wcmV2TXVzaWMgPSAnJztcbiAgICAgIHRoaXMucHJldkluZGV4ID0gJyc7XG4gICAgICB0aGlzLiRlbHMubXBsYXllci5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgbXAzX2FkZHJlc3MpO1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIudm9sdW1lID0gMC41O1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIucGxheSgpO1xuICAgICAgdGhpcy5wbGF5U3RhdHVzID0gdHJ1ZTtcbiAgICB9LFxuICAgIGdldE11c2ljOiBmdW5jdGlvbiBnZXRNdXNpYygpIHtcbiAgICAgIHZhciBtX3NlY29uZCA9IHVuZGVmaW5lZCxcbiAgICAgICAgICBtX21pbnV0ZSA9IHVuZGVmaW5lZDtcbiAgICAgIHZhciB0ZW1wX21pbnV0ZSA9IHBhcnNlSW50KHRoaXMuJGVscy5tcGxheWVyLmR1cmF0aW9uIC8gNjApO1xuICAgICAgaWYgKHRlbXBfbWludXRlLnRvU3RyaW5nKCkubGVuZ3RoID4gMSkge1xuICAgICAgICBtX21pbnV0ZSA9ICcnICsgdGVtcF9taW51dGU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtX21pbnV0ZSA9ICcwJyArIHRlbXBfbWludXRlO1xuICAgICAgfVxuICAgICAgdmFyIHRlbXBfc2Vjb25kID0gcGFyc2VJbnQodGhpcy4kZWxzLm1wbGF5ZXIuZHVyYXRpb24gJSA2MCk7XG4gICAgICBpZiAodGVtcF9zZWNvbmQudG9TdHJpbmcoKS5sZW5ndGggPiAxKSB7XG4gICAgICAgIG1fc2Vjb25kID0gJycgKyB0ZW1wX3NlY29uZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1fc2Vjb25kID0gJzAnICsgdGVtcF9zZWNvbmQ7XG4gICAgICB9XG4gICAgICB0aGlzLm11c2ljdGltZSA9IG1fbWludXRlICsgJzonICsgbV9zZWNvbmQ7XG4gICAgfSxcbiAgICBwbGF5RXZlbnQ6IGZ1bmN0aW9uIHBsYXlFdmVudCgpIHtcbiAgICAgIGlmICghdGhpcy5jaGVja1N0YXR1cygpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHZhciBjX3NlY29uZCA9IHVuZGVmaW5lZCxcbiAgICAgICAgICBjX21pbnV0ZSA9IHVuZGVmaW5lZDtcbiAgICAgIHZhciB0ZW1wX21pbnV0ZSA9IHBhcnNlSW50KHRoaXMuJGVscy5tcGxheWVyLmN1cnJlbnRUaW1lIC8gNjApO1xuICAgICAgaWYgKHRlbXBfbWludXRlLnRvU3RyaW5nKCkubGVuZ3RoID4gMSkge1xuICAgICAgICBjX21pbnV0ZSA9ICcnICsgdGVtcF9taW51dGU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjX21pbnV0ZSA9ICcwJyArIHRlbXBfbWludXRlO1xuICAgICAgfVxuICAgICAgdmFyIHRlbXBfc2Vjb25kID0gcGFyc2VJbnQodGhpcy4kZWxzLm1wbGF5ZXIuY3VycmVudFRpbWUgJSA2MCk7XG4gICAgICBpZiAodGVtcF9zZWNvbmQudG9TdHJpbmcoKS5sZW5ndGggPiAxKSB7XG4gICAgICAgIGNfc2Vjb25kID0gJycgKyB0ZW1wX3NlY29uZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNfc2Vjb25kID0gJzAnICsgdGVtcF9zZWNvbmQ7XG4gICAgICB9XG4gICAgICB0aGlzLmN1cnRpbWUgPSBjX21pbnV0ZSArICc6JyArIGNfc2Vjb25kO1xuICAgICAgdmFyIHBsYXlfdGltZSA9IE1hdGguZmxvb3IodGhpcy4kZWxzLm1wbGF5ZXIuY3VycmVudFRpbWUpLnRvU3RyaW5nKCk7XG4gICAgICB0aGlzLmRpc3BsYXlfbHJjKHBsYXlfdGltZSk7XG4gICAgICB2YXIgYnVmZmVyX3BlcmNlbnQgPSB0aGlzLiRlbHMubXBsYXllci5idWZmZXJlZC5lbmQoMCkgLyB0aGlzLiRlbHMubXBsYXllci5kdXJhdGlvbjtcbiAgICAgIHZhciBjdXJyZW50X3BlcmNlbnQgPSB0aGlzLiRlbHMubXBsYXllci5jdXJyZW50VGltZSAvIHRoaXMuJGVscy5tcGxheWVyLmR1cmF0aW9uO1xuICAgICAgdGhpcy4kZWxzLmJ1ZmZlci5zdHlsZS50cmFuc2Zvcm0gPSBcInNjYWxlWChcIiArIGJ1ZmZlcl9wZXJjZW50ICsgXCIpXCI7XG4gICAgICB0aGlzLiRlbHMucGxheXRpbWUuc3R5bGUudHJhbnNmb3JtID0gXCJzY2FsZVgoXCIgKyBjdXJyZW50X3BlcmNlbnQgKyBcIilcIjtcbiAgICB9LFxuICAgIGNoYW5nZVByb2dyZXNzOiBmdW5jdGlvbiBjaGFuZ2VQcm9ncmVzcyhldmVudCkge1xuICAgICAgaWYgKCF0aGlzLmNoZWNrU3RhdHVzKCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdmFyIHByb2dyZXNzWCA9IGV2ZW50LmNsaWVudFggLSB0aGlzLiRlbHMucHJvZ3Jlc3MuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkubGVmdDtcbiAgICAgIHRoaXMuJGVscy5tcGxheWVyLmN1cnJlbnRUaW1lID0gcGFyc2VJbnQocHJvZ3Jlc3NYIC8gMjQwICogdGhpcy4kZWxzLm1wbGF5ZXIuZHVyYXRpb24pO1xuICAgIH0sXG4gICAgZGlzcGxheV9scmM6IGZ1bmN0aW9uIGRpc3BsYXlfbHJjKHBsYXlfdGltZSkge1xuICAgICAgaWYgKCF0aGlzLmNoZWNrU3RhdHVzKCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdmFyIGxyY3MgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCdscmMnKTtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbHJjcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoaSArIDEgPCBscmNzLmxlbmd0aCkge1xuICAgICAgICAgIGlmIChscmNzW2ldLmdldEF0dHJpYnV0ZSgnZHRpbWUnKSA8PSB0aGlzLiRlbHMubXBsYXllci5jdXJyZW50VGltZSAmJiB0aGlzLiRlbHMubXBsYXllci5jdXJyZW50VGltZSA8IGxyY3NbaSArIDFdLmdldEF0dHJpYnV0ZSgnZHRpbWUnKSkge1xuICAgICAgICAgICAgaWYgKGxyY3NbaV0uY2xhc3NMaXN0KSB7XG4gICAgICAgICAgICAgIGxyY3NbaV0uY2xhc3NMaXN0LmFkZCgnbHJjLWN1cnJlbnQnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGxyY3NbaV0uY2xhc3NOYW1lICs9ICcgJyArICdscmMtY3VycmVudCc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAobHJjc1tpXS5vZmZzZXRUb3AgPiAyMDApIHtcbiAgICAgICAgICAgICAgdGhpcy4kZWxzLmx5cmljYm94LnNjcm9sbFRvcCA9IGxyY3NbaV0ub2Zmc2V0VG9wIC0gMjAwO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpZiAobHJjc1tpXS5jbGFzc0xpc3QpIHtcbiAgICAgICAgICAgICAgbHJjc1tpXS5jbGFzc0xpc3QucmVtb3ZlKCdscmMtY3VycmVudCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbHJjc1tpXS5jbGFzc05hbWUgPSBscmNzW2ldLmNsYXNzTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoJyhefFxcXFxiKScgKyAnbHJjLWN1cnJlbnQnLnNwbGl0KCcgJykuam9pbignfCcpICsgJyhcXFxcYnwkKScsICdnaScpLCAnICcpOyAvL2llOFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKGxyY3NbbHJjcy5sZW5ndGggLSAxXS5nZXRBdHRyaWJ1dGUoJ2R0aW1lJykgPD0gdGhpcy4kZWxzLm1wbGF5ZXIuY3VycmVudFRpbWUpIHtcbiAgICAgICAgaWYgKGxyY3NbbHJjcy5sZW5ndGggLSAxXS5jbGFzc0xpc3QpIHtcbiAgICAgICAgICBscmNzW2xyY3MubGVuZ3RoIC0gMV0uY2xhc3NMaXN0LmFkZCgnbHJjLWN1cnJlbnQnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBscmNzW2xyY3MubGVuZ3RoIC0gMV0uY2xhc3NOYW1lICs9ICcgJyArICdscmMtY3VycmVudCc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
