"use strict";Vue.config.debug=!0;var vm=new Vue({el:"#ym-player",data:{song_name:"",album_name:"",artist_name:"",showlrc:[],musicArray:"",playingMusic:"",playingIndex:"",havevoice:!0,playStatus:!0,prevIndex:"",statusText:"",prevMusic:"",followIndex:"",followMusic:"",volume:.5,curtime:"00:00",musictime:"00:00",loaded:!1},created:function(){this.loadMusic()},methods:{getJSON:function(t){var e=new Promise(function(e,s){function i(){4===this.readyState&&(200===this.status?e(this.response):s(new Error(this.statusText)))}var r=new XMLHttpRequest;r.open("GET",t),r.onreadystatechange=i,r.responseType="json",r.setRequestHeader("Accept","application/json"),r.send()});return e},changePlay:function(){0==this.playStatus?(this.playStatus=!0,this.$els.mplayer.play()):(this.playStatus=!1,this.$els.mplayer.pause())},loadMusic:function(t){var e=t?"getSong.php?id="+t:"getSong.php?id=0";this.getJSON(e).then(function(t){vm.statusText="",vm.musicArray=t.tracks,vm.musicLength=vm.musicArray.length,vm.$els.album.style.backgroundImage="url("+t.cover+")","no"!=t.lrc?vm.showlrc=t.lrc:vm.showlrc={0:"暂无歌词"},vm.song_name=t.music_name,vm.album_name=t.album_name,vm.artist_name=t.artists,vm.playingMusic=t.id,vm.playingIndex=t.index,vm.loaded=!0,vm.$els.mplayer.setAttribute("src",t.mp3),vm.$els.mplayer.volume=.5,vm.$els.mplayer.play(),vm.$els.mplayer.onerror=function(){vm.statusText="网易API获取的歌曲链接无法播放..稍后进入下一首",window.setTimeout(function(){vm.nextMusic()},3e3)}},function(t){alert("服务器通信异常")})},changeVoice:function(t){this.$els.mplayer.volume=t.target.value/10,0==t.target.value?this.havevoice=!1:(this.havevoice=!0,this.volume=t.target.value)},changeSound:function(){1==this.havevoice?(this.havevoice=!1,this.$els.mplayer.volume=0,this.$els.soundrange.value=0):(this.havevoice=!0,this.$els.mplayer.volume=this.volume/10,this.$els.soundrange.value=this.volume)},checkStatus:function(){return 0!=this.$els.mplayer.buffered.length},nextMusic:function(){this.statusText="";var t,e;this.followMusic&&this.followIndex?(t=this.followIndex,e=this.followMusic):(t=Math.ceil(Math.random()*this.musicLength),e=this.musicArray[t].id),this.followIndex="",this.followMusic="",this.prevMusic=this.playingMusic,this.prevIndex=this.playingIndex,this.showlrc=[],this.getJSON("getLyrics.php?id="+e).then(function(t){"no"!=t.lrc?vm.showlrc=t.lrc:vm.showlrc={0:"暂无歌词"}},function(t){vm.showlrc={0:"暂无歌词"}});var s="";for(var i in this.musicArray[t].artists)s+=this.musicArray[t].artists[i].name;this.$els.album.style.backgroundImage="url("+this.musicArray[t].album.picUrl+")",this.playingMusic=this.musicArray[t].id,this.playingIndex=t,this.song_name=this.musicArray[t].name,this.album_name=this.musicArray[t].album.name,this.artist_name=s;var r=this.musicArray[t].mp3Url;this.$els.mplayer.setAttribute("src",r),this.$els.mplayer.volume=.5,this.$els.mplayer.play(),this.$els.mplayer.onerror=function(){vm.statusText="网易API抽风了..歌曲无法获取，稍后进入下一首",window.setTimeout(function(){vm.nextMusic()},3e3)},this.playStatus=!0},backMusic:function(){if(!this.prevMusic||!this.prevIndex)return!1;this.statusText="",this.followIndex=this.playingIndex,this.followMusic=this.playingMusic,this.showlrc=[],this.getJSON("getLyrics.php?id="+this.prevMusic).then(function(t){"no"!=t.lrc?vm.showlrc=t.lrc:vm.showlrc={0:"暂无歌词"}},function(t){vm.showlrc={0:"暂无歌词"}});var t="";for(var e in this.musicArray[this.prevIndex].artists)t+=this.musicArray[this.prevIndex].artists[e].name;this.$els.album.style.backgroundImage="url("+this.musicArray[this.prevIndex].album.picUrl+")",this.playingMusic=this.musicArray[this.prevIndex].id,this.playingIndex=this.prevIndex,this.song_name=this.musicArray[this.prevIndex].name,this.album_name=this.musicArray[this.prevIndex].album.name,this.artist_name=t;var s=this.musicArray[this.prevIndex].mp3Url;this.prevMusic="",this.prevIndex="",this.$els.mplayer.setAttribute("src",s),this.$els.mplayer.volume=.5,this.$els.mplayer.play(),this.$els.mplayer.onerror=function(){vm.statusText="网易API抽风了..歌曲无法获取，稍后进入下一首",window.setTimeout(function(){vm.nextMusic()},3e3)},this.playStatus=!0},getMusic:function(){var t=void 0,e=void 0,s=parseInt(this.$els.mplayer.duration/60);e=s.toString().length>1?""+s:"0"+s;var i=parseInt(this.$els.mplayer.duration%60);t=i.toString().length>1?""+i:"0"+i,this.musictime=e+":"+t},playEvent:function(){if(!this.checkStatus())return!1;var t=void 0,e=void 0,s=parseInt(this.$els.mplayer.currentTime/60);e=s.toString().length>1?""+s:"0"+s;var i=parseInt(this.$els.mplayer.currentTime%60);t=i.toString().length>1?""+i:"0"+i,this.curtime=e+":"+t;var r=Math.floor(this.$els.mplayer.currentTime).toString();this.display_lrc(r);var a=this.$els.mplayer.buffered.end(0)/this.$els.mplayer.duration,l=this.$els.mplayer.currentTime/this.$els.mplayer.duration;this.$els.buffer.style.transform="scaleX("+a+")",this.$els.playtime.style.transform="scaleX("+l+")"},changeProgress:function(t){if(!this.checkStatus())return!1;var e=t.clientX-this.$els.progress.getBoundingClientRect().left;this.$els.mplayer.currentTime=parseInt(e/240*this.$els.mplayer.duration)},display_lrc:function(t){if(!this.checkStatus())return!1;for(var e=document.getElementsByClassName("lrc"),s=0;s<e.length;s++)s+1<e.length&&(e[s].getAttribute("dtime")<=this.$els.mplayer.currentTime&&this.$els.mplayer.currentTime<e[s+1].getAttribute("dtime")?(e[s].classList?e[s].classList.add("lrc-current"):e[s].className+=" lrc-current",e[s].offsetTop>200&&(this.$els.lyricbox.scrollTop=e[s].offsetTop-200)):e[s].classList?e[s].classList.remove("lrc-current"):e[s].className=e[s].className.replace(new RegExp("(^|\\b)"+"lrc-current".split(" ").join("|")+"(\\b|$)","gi")," "));e[e.length-1].getAttribute("dtime")<=this.$els.mplayer.currentTime&&(e[e.length-1].classList?e[e.length-1].classList.add("lrc-current"):e[e.length-1].className+=" lrc-current")}}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBsYXllci5qcyJdLCJuYW1lcyI6WyJWdWUiLCJjb25maWciLCJkZWJ1ZyIsInZtIiwiZWwiLCJkYXRhIiwic29uZ19uYW1lIiwiYWxidW1fbmFtZSIsImFydGlzdF9uYW1lIiwic2hvd2xyYyIsIm11c2ljQXJyYXkiLCJwbGF5aW5nTXVzaWMiLCJwbGF5aW5nSW5kZXgiLCJoYXZldm9pY2UiLCJwbGF5U3RhdHVzIiwicHJldkluZGV4Iiwic3RhdHVzVGV4dCIsInByZXZNdXNpYyIsImZvbGxvd0luZGV4IiwiZm9sbG93TXVzaWMiLCJ2b2x1bWUiLCJjdXJ0aW1lIiwibXVzaWN0aW1lIiwibG9hZGVkIiwiY3JlYXRlZCIsInRoaXMiLCJsb2FkTXVzaWMiLCJtZXRob2RzIiwiZ2V0SlNPTiIsInVybCIsInByb21pc2UiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImhhbmRsZXIiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwicmVzcG9uc2UiLCJFcnJvciIsImNsaWVudCIsIlhNTEh0dHBSZXF1ZXN0Iiwib3BlbiIsIm9ucmVhZHlzdGF0ZWNoYW5nZSIsInJlc3BvbnNlVHlwZSIsInNldFJlcXVlc3RIZWFkZXIiLCJzZW5kIiwiY2hhbmdlUGxheSIsIiRlbHMiLCJtcGxheWVyIiwicGxheSIsInBhdXNlIiwiaWQiLCJ0aGVuIiwidHJhY2tzIiwibXVzaWNMZW5ndGgiLCJsZW5ndGgiLCJhbGJ1bSIsInN0eWxlIiwiYmFja2dyb3VuZEltYWdlIiwiY292ZXIiLCJscmMiLCIwIiwibXVzaWNfbmFtZSIsImFydGlzdHMiLCJpbmRleCIsInNldEF0dHJpYnV0ZSIsIm1wMyIsIm9uZXJyb3IiLCJ3aW5kb3ciLCJzZXRUaW1lb3V0IiwibmV4dE11c2ljIiwiZXJyb3IiLCJhbGVydCIsImNoYW5nZVZvaWNlIiwiZXZlbnQiLCJ0YXJnZXQiLCJ2YWx1ZSIsImNoYW5nZVNvdW5kIiwic291bmRyYW5nZSIsImNoZWNrU3RhdHVzIiwiYnVmZmVyZWQiLCJyYW5kb21faW5kZXgiLCJyYW5kb21faWQiLCJNYXRoIiwiY2VpbCIsInJhbmRvbSIsImFydGlzdHNfbmFtZSIsImkiLCJuYW1lIiwicGljVXJsIiwibXAzX2FkZHJlc3MiLCJtcDNVcmwiLCJiYWNrTXVzaWMiLCJnZXRNdXNpYyIsIm1fc2Vjb25kIiwidW5kZWZpbmVkIiwibV9taW51dGUiLCJ0ZW1wX21pbnV0ZSIsInBhcnNlSW50IiwiZHVyYXRpb24iLCJ0b1N0cmluZyIsInRlbXBfc2Vjb25kIiwicGxheUV2ZW50IiwiY19zZWNvbmQiLCJjX21pbnV0ZSIsImN1cnJlbnRUaW1lIiwicGxheV90aW1lIiwiZmxvb3IiLCJkaXNwbGF5X2xyYyIsImJ1ZmZlcl9wZXJjZW50IiwiZW5kIiwiY3VycmVudF9wZXJjZW50IiwiYnVmZmVyIiwidHJhbnNmb3JtIiwicGxheXRpbWUiLCJjaGFuZ2VQcm9ncmVzcyIsInByb2dyZXNzWCIsImNsaWVudFgiLCJwcm9ncmVzcyIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImxlZnQiLCJscmNzIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lIiwiZ2V0QXR0cmlidXRlIiwiY2xhc3NMaXN0IiwiYWRkIiwiY2xhc3NOYW1lIiwib2Zmc2V0VG9wIiwibHlyaWNib3giLCJzY3JvbGxUb3AiLCJyZW1vdmUiLCJyZXBsYWNlIiwiUmVnRXhwIiwic3BsaXQiLCJqb2luIl0sIm1hcHBpbmdzIjoiQUFJQSxZQUVBQSxLQUFJQyxPQUFPQyxPQUFRLENBQ25CLElBQUlDLElBQUssR0FBSUgsTUFDWEksR0FBSSxhQUNKQyxNQUNFQyxVQUFXLEdBQ1hDLFdBQVksR0FDWkMsWUFBYSxHQUNiQyxXQUNBQyxXQUFZLEdBQ1pDLGFBQWMsR0FDZEMsYUFBYyxHQUNkQyxXQUFXLEVBQ1hDLFlBQVksRUFDWkMsVUFBVyxHQUNYQyxXQUFZLEdBQ1pDLFVBQVcsR0FDWEMsWUFBYSxHQUNiQyxZQUFhLEdBQ2JDLE9BQVEsR0FDUkMsUUFBUyxRQUNUQyxVQUFXLFFBQ1hDLFFBQVEsR0FFVkMs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QVVDLElBQUksZUFFcENMLEVBQUtBLEVBQUtsRSxPQUFTLEdBQUd3RSxXQUFhIiwiZmlsZSI6InBsYXllci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuKiB5UGxheWVyXG4qIEF1dGhvciB5YW5nemoxOTkyXG4qL1xuJ3VzZSBzdHJpY3QnO1xuXG5WdWUuY29uZmlnLmRlYnVnID0gdHJ1ZTtcbnZhciB2bSA9IG5ldyBWdWUoe1xuICBlbDogJyN5bS1wbGF5ZXInLFxuICBkYXRhOiB7XG4gICAgc29uZ19uYW1lOiAnJyxcbiAgICBhbGJ1bV9uYW1lOiAnJyxcbiAgICBhcnRpc3RfbmFtZTogJycsXG4gICAgc2hvd2xyYzogW10sXG4gICAgbXVzaWNBcnJheTogJycsXG4gICAgcGxheWluZ011c2ljOiAnJyxcbiAgICBwbGF5aW5nSW5kZXg6ICcnLFxuICAgIGhhdmV2b2ljZTogdHJ1ZSxcbiAgICBwbGF5U3RhdHVzOiB0cnVlLFxuICAgIHByZXZJbmRleDogJycsXG4gICAgc3RhdHVzVGV4dDogJycsXG4gICAgcHJldk11c2ljOiAnJyxcbiAgICBmb2xsb3dJbmRleDogJycsXG4gICAgZm9sbG93TXVzaWM6ICcnLFxuICAgIHZvbHVtZTogMC41LFxuICAgIGN1cnRpbWU6ICcwMDowMCcsXG4gICAgbXVzaWN0aW1lOiAnMDA6MDAnLFxuICAgIGxvYWRlZDogZmFsc2VcbiAgfSxcbiAgY3JlYXRlZDogZnVuY3Rpb24gY3JlYXRlZCgpIHtcbiAgICB0aGlzLmxvYWRNdXNpYygpO1xuICB9LFxuICBtZXRob2RzOiB7XG4gICAgLyoqXG4gICAgICogW2dldEpTT04gZ2VuZXJhdGUgQUpBWCByZXF1ZXN0XVxuICAgICAqIEBwYXJhbSAge1tzdHJpbmddfSB1cmwgW3JlcXVlc3QgdXJsXVxuICAgICAqIEByZXR1cm4ge1twcm9taXNlXX0gXG4gICAgICovXG4gICAgZ2V0SlNPTjogZnVuY3Rpb24gZ2V0SlNPTih1cmwpIHtcbiAgICAgIHZhciBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICB2YXIgY2xpZW50ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIGNsaWVudC5vcGVuKFwiR0VUXCIsIHVybCk7XG4gICAgICAgIGNsaWVudC5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBoYW5kbGVyO1xuICAgICAgICBjbGllbnQucmVzcG9uc2VUeXBlID0gXCJqc29uXCI7XG4gICAgICAgIGNsaWVudC5zZXRSZXF1ZXN0SGVhZGVyKFwiQWNjZXB0XCIsIFwiYXBwbGljYXRpb24vanNvblwiKTtcbiAgICAgICAgY2xpZW50LnNlbmQoKTtcbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlcigpIHtcbiAgICAgICAgICBpZiAodGhpcy5yZWFkeVN0YXRlICE9PSA0KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gMjAwKSB7XG4gICAgICAgICAgICByZXNvbHZlKHRoaXMucmVzcG9uc2UpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKHRoaXMuc3RhdHVzVGV4dCkpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gcHJvbWlzZTtcbiAgICB9LFxuICAgIC8qKlxuICAgICAqIFtjaGFuZ2VQbGF5IFBsYXkgc3RhdHVzIDzigJTigJQ+ICBQYXVzZSBzdGF1dHMgXVxuICAgICAqL1xuICAgIGNoYW5nZVBsYXk6IGZ1bmN0aW9uIGNoYW5nZVBsYXkoKSB7XG4gICAgICBpZiAodGhpcy5wbGF5U3RhdHVzID09IGZhbHNlKSB7XG4gICAgICAgIHRoaXMucGxheVN0YXR1cyA9IHRydWU7XG4gICAgICAgIHRoaXMuJGVscy5tcGxheWVyLnBsYXkoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucGxheVN0YXR1cyA9IGZhbHNlO1xuICAgICAgICB0aGlzLiRlbHMubXBsYXllci5wYXVzZSgpO1xuICAgICAgfVxuICAgIH0sXG4gICAgLyoqXG4gICAgICogW2xvYWRNdXNpYyBsb2FkIG11c2ljIHdpdGggc29uZyBpZCBvciByYW5kb20gc29uZ11cbiAgICAgKiBAcGFyYW0gIHtbaW50XX0gaWQgW05ldGVhc2Ugc29uZyBpZF1cbiAgICAgKi9cbiAgICBsb2FkTXVzaWM6IGZ1bmN0aW9uIGxvYWRNdXNpYyhpZCkge1xuICAgICAgdmFyIHVybCA9IGlkID8gJ2dldFNvbmcucGhwP2lkPScgKyBpZCA6ICdnZXRTb25nLnBocD9pZD0wJztcbiAgICAgIHRoaXMuZ2V0SlNPTih1cmwpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgdm0uc3RhdHVzVGV4dCA9ICcnO1xuICAgICAgICB2bS5tdXNpY0FycmF5ID0gZGF0YS50cmFja3M7XG4gICAgICAgIHZtLm11c2ljTGVuZ3RoID0gdm0ubXVzaWNBcnJheS5sZW5ndGg7XG4gICAgICAgIHZtLiRlbHMuYWxidW0uc3R5bGUuYmFja2dyb3VuZEltYWdlID0gJ3VybCgnICsgZGF0YS5jb3ZlciArICcpJztcbiAgICAgICAgaWYgKGRhdGEubHJjICE9IFwibm9cIikge1xuICAgICAgICAgIHZtLnNob3dscmMgPSBkYXRhLmxyYztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2bS5zaG93bHJjID0geyBcIjBcIjogXCLmmoLml6DmrYzor41cIiB9O1xuICAgICAgICB9XG4gICAgICAgIHZtLnNvbmdfbmFtZSA9IGRhdGEubXVzaWNfbmFtZTtcbiAgICAgICAgdm0uYWxidW1fbmFtZSA9IGRhdGEuYWxidW1fbmFtZTtcbiAgICAgICAgdm0uYXJ0aXN0X25hbWUgPSBkYXRhLmFydGlzdHM7XG4gICAgICAgIHZtLnBsYXlpbmdNdXNpYyA9IGRhdGEuaWQ7XG4gICAgICAgIHZtLnBsYXlpbmdJbmRleCA9IGRhdGEuaW5kZXg7XG4gICAgICAgIHZtLmxvYWRlZCA9IHRydWU7XG4gICAgICAgIHZtLiRlbHMubXBsYXllci5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgZGF0YS5tcDMpO1xuICAgICAgICB2bS4kZWxzLm1wbGF5ZXIudm9sdW1lID0gMC41O1xuICAgICAgICB2bS4kZWxzLm1wbGF5ZXIucGxheSgpO1xuICAgICAgICB2bS4kZWxzLm1wbGF5ZXIub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2bS5zdGF0dXNUZXh0ID0gJ+e9keaYk0FQSeiOt+WPlueahOatjOabsumTvuaOpeaXoOazleaSreaUvi4u56iN5ZCO6L+b5YWl5LiL5LiA6aaWJztcbiAgICAgICAgICB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB2bS5uZXh0TXVzaWMoKTtcbiAgICAgICAgICB9LCAzMDAwKTtcbiAgICAgICAgfTtcbiAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBhbGVydCgn5pyN5Yqh5Zmo6YCa5L+h5byC5bi4Jyk7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIC8qKlxuICAgICAqIFtjaGFuZ2VWb2ljZSBjaGFuZ2UgcGxheWVyICdzIHZvbHVtZSBdXG4gICAgICovXG4gICAgY2hhbmdlVm9pY2U6IGZ1bmN0aW9uIGNoYW5nZVZvaWNlKGV2ZW50KSB7XG4gICAgICB0aGlzLiRlbHMubXBsYXllci52b2x1bWUgPSBldmVudC50YXJnZXQudmFsdWUgLyAxMDtcbiAgICAgIGlmIChldmVudC50YXJnZXQudmFsdWUgPT0gMCkge1xuICAgICAgICB0aGlzLmhhdmV2b2ljZSA9IGZhbHNlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5oYXZldm9pY2UgPSB0cnVlO1xuICAgICAgICB0aGlzLnZvbHVtZSA9IGV2ZW50LnRhcmdldC52YWx1ZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIC8qKlxuICAgICAqIFtjaGFuZ2VTb3VuZCBtdXRlIDzigJTigJQ+IHVzZWQgdm9sdW1uXVxuICAgICAqL1xuICAgIGNoYW5nZVNvdW5kOiBmdW5jdGlvbiBjaGFuZ2VTb3VuZCgpIHtcbiAgICAgIGlmICh0aGlzLmhhdmV2b2ljZSA9PSB0cnVlKSB7XG4gICAgICAgIHRoaXMuaGF2ZXZvaWNlID0gZmFsc2U7XG4gICAgICAgIHRoaXMuJGVscy5tcGxheWVyLnZvbHVtZSA9IDA7XG4gICAgICAgIHRoaXMuJGVscy5zb3VuZHJhbmdlLnZhbHVlID0gMDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuaGF2ZXZvaWNlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIudm9sdW1lID0gdGhpcy52b2x1bWUgLyAxMDtcbiAgICAgICAgdGhpcy4kZWxzLnNvdW5kcmFuZ2UudmFsdWUgPSB0aGlzLnZvbHVtZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIC8qKlxuICAgICAqIFtjaGVja1N0YXR1cyBjaGVjayBzb25nJ3MgbG9hZGluZyBzdGF0dXNdXG4gICAgICogQHJldHVybiB7W2Jvb2xlYW5dfVxuICAgICAqL1xuICAgIGNoZWNrU3RhdHVzOiBmdW5jdGlvbiBjaGVja1N0YXR1cygpIHtcbiAgICAgIGlmICh0aGlzLiRlbHMubXBsYXllci5idWZmZXJlZC5sZW5ndGggPT0gMCkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIG5leHRNdXNpYzogZnVuY3Rpb24gbmV4dE11c2ljKCkge1xuICAgICAgdGhpcy5zdGF0dXNUZXh0ID0gJyc7XG4gICAgICB2YXIgcmFuZG9tX2luZGV4O1xuICAgICAgdmFyIHJhbmRvbV9pZDtcbiAgICAgIGlmICghdGhpcy5mb2xsb3dNdXNpYyB8fCAhdGhpcy5mb2xsb3dJbmRleCkge1xuICAgICAgICByYW5kb21faW5kZXggPSBNYXRoLmNlaWwoTWF0aC5yYW5kb20oKSAqIHRoaXMubXVzaWNMZW5ndGgpO1xuICAgICAgICByYW5kb21faWQgPSB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5pZDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJhbmRvbV9pbmRleCA9IHRoaXMuZm9sbG93SW5kZXg7XG4gICAgICAgIHJhbmRvbV9pZCA9IHRoaXMuZm9sbG93TXVzaWM7XG4gICAgICB9XG4gICAgICB0aGlzLmZvbGxvd0luZGV4ID0gJyc7XG4gICAgICB0aGlzLmZvbGxvd011c2ljID0gJyc7XG4gICAgICB0aGlzLnByZXZNdXNpYyA9IHRoaXMucGxheWluZ011c2ljO1xuICAgICAgdGhpcy5wcmV2SW5kZXggPSB0aGlzLnBsYXlpbmdJbmRleDtcbiAgICAgIHRoaXMuc2hvd2xyYyA9IFtdO1xuICAgICAgdGhpcy5nZXRKU09OKCdnZXRMeXJpY3MucGhwP2lkPScgKyByYW5kb21faWQpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgaWYgKGRhdGEubHJjICE9IFwibm9cIikge1xuICAgICAgICAgIHZtLnNob3dscmMgPSBkYXRhLmxyYztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2bS5zaG93bHJjID0geyBcIjBcIjogXCLmmoLml6DmrYzor41cIiB9O1xuICAgICAgICB9XG4gICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgdm0uc2hvd2xyYyA9IHsgXCIwXCI6IFwi5pqC5peg5q2M6K+NXCIgfTtcbiAgICAgIH0pO1xuICAgICAgdmFyIGFydGlzdHNfbmFtZSA9ICcnO1xuICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5hcnRpc3RzKSB7XG4gICAgICAgIGFydGlzdHNfbmFtZSArPSB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5hcnRpc3RzW2ldLm5hbWU7XG4gICAgICB9XG4gICAgICB0aGlzLiRlbHMuYWxidW0uc3R5bGUuYmFja2dyb3VuZEltYWdlID0gJ3VybCgnICsgdGhpcy5tdXNpY0FycmF5W3JhbmRvbV9pbmRleF0uYWxidW0ucGljVXJsICsgJyknO1xuICAgICAgdGhpcy5wbGF5aW5nTXVzaWMgPSB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5pZDtcbiAgICAgIHRoaXMucGxheWluZ0luZGV4ID0gcmFuZG9tX2luZGV4O1xuICAgICAgdGhpcy5zb25nX25hbWUgPSB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5uYW1lO1xuICAgICAgdGhpcy5hbGJ1bV9uYW1lID0gdGhpcy5tdXNpY0FycmF5W3JhbmRvbV9pbmRleF0uYWxidW0ubmFtZTtcbiAgICAgIHRoaXMuYXJ0aXN0X25hbWUgPSBhcnRpc3RzX25hbWU7XG4gICAgICB2YXIgbXAzX2FkZHJlc3MgPSB0aGlzLm11c2ljQXJyYXlbcmFuZG9tX2luZGV4XS5tcDNVcmw7XG4gICAgICB0aGlzLiRlbHMubXBsYXllci5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgbXAzX2FkZHJlc3MpO1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIudm9sdW1lID0gMC41O1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIucGxheSgpO1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdm0uc3RhdHVzVGV4dCA9ICfnvZHmmJNBUEnmir3po47kuoYuLuatjOabsuaXoOazleiOt+WPlu+8jOeojeWQjui/m+WFpeS4i+S4gOmmlic7XG4gICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2bS5uZXh0TXVzaWMoKTtcbiAgICAgICAgfSwgMzAwMCk7XG4gICAgICB9O1xuICAgICAgdGhpcy5wbGF5U3RhdHVzID0gdHJ1ZTtcbiAgICB9LFxuICAgIGJhY2tNdXNpYzogZnVuY3Rpb24gYmFja011c2ljKCkge1xuICAgICAgaWYgKCF0aGlzLnByZXZNdXNpYyB8fCAhdGhpcy5wcmV2SW5kZXgpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgdGhpcy5zdGF0dXNUZXh0ID0gJyc7XG4gICAgICB0aGlzLmZvbGxvd0luZGV4ID0gdGhpcy5wbGF5aW5nSW5kZXg7XG4gICAgICB0aGlzLmZvbGxvd011c2ljID0gdGhpcy5wbGF5aW5nTXVzaWM7XG4gICAgICB0aGlzLnNob3dscmMgPSBbXTtcbiAgICAgIHRoaXMuZ2V0SlNPTignZ2V0THlyaWNzLnBocD9pZD0nICsgdGhpcy5wcmV2TXVzaWMpLnRoZW4oZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAgICAgaWYgKGRhdGEubHJjICE9IFwibm9cIikge1xuICAgICAgICAgIHZtLnNob3dscmMgPSBkYXRhLmxyYztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB2bS5zaG93bHJjID0geyBcIjBcIjogXCLmmoLml6DmrYzor41cIiB9O1xuICAgICAgICB9XG4gICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgdm0uc2hvd2xyYyA9IHsgXCIwXCI6IFwi5pqC5peg5q2M6K+NXCIgfTtcbiAgICAgIH0pO1xuICAgICAgdmFyIGFydGlzdHNfbmFtZSA9ICcnO1xuICAgICAgZm9yICh2YXIgaSBpbiB0aGlzLm11c2ljQXJyYXlbdGhpcy5wcmV2SW5kZXhdLmFydGlzdHMpIHtcbiAgICAgICAgYXJ0aXN0c19uYW1lICs9IHRoaXMubXVzaWNBcnJheVt0aGlzLnByZXZJbmRleF0uYXJ0aXN0c1tpXS5uYW1lO1xuICAgICAgfVxuICAgICAgdGhpcy4kZWxzLmFsYnVtLnN0eWxlLmJhY2tncm91bmRJbWFnZSA9ICd1cmwoJyArIHRoaXMubXVzaWNBcnJheVt0aGlzLnByZXZJbmRleF0uYWxidW0ucGljVXJsICsgJyknO1xuICAgICAgdGhpcy5wbGF5aW5nTXVzaWMgPSB0aGlzLm11c2ljQXJyYXlbdGhpcy5wcmV2SW5kZXhdLmlkO1xuICAgICAgdGhpcy5wbGF5aW5nSW5kZXggPSB0aGlzLnByZXZJbmRleDtcbiAgICAgIHRoaXMuc29uZ19uYW1lID0gdGhpcy5tdXNpY0FycmF5W3RoaXMucHJldkluZGV4XS5uYW1lO1xuICAgICAgdGhpcy5hbGJ1bV9uYW1lID0gdGhpcy5tdXNpY0FycmF5W3RoaXMucHJldkluZGV4XS5hbGJ1bS5uYW1lO1xuICAgICAgdGhpcy5hcnRpc3RfbmFtZSA9IGFydGlzdHNfbmFtZTtcbiAgICAgIHZhciBtcDNfYWRkcmVzcyA9IHRoaXMubXVzaWNBcnJheVt0aGlzLnByZXZJbmRleF0ubXAzVXJsO1xuICAgICAgdGhpcy5wcmV2TXVzaWMgPSAnJztcbiAgICAgIHRoaXMucHJldkluZGV4ID0gJyc7XG4gICAgICB0aGlzLiRlbHMubXBsYXllci5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgbXAzX2FkZHJlc3MpO1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIudm9sdW1lID0gMC41O1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIucGxheSgpO1xuICAgICAgdGhpcy4kZWxzLm1wbGF5ZXIub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdm0uc3RhdHVzVGV4dCA9ICfnvZHmmJNBUEnmir3po47kuoYuLuatjOabsuaXoOazleiOt+WPlu+8jOeojeWQjui/m+WFpeS4i+S4gOmmlic7XG4gICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB2bS5uZXh0TXVzaWMoKTtcbiAgICAgICAgfSwgMzAwMCk7XG4gICAgICB9O1xuICAgICAgdGhpcy5wbGF5U3RhdHVzID0gdHJ1ZTtcbiAgICB9LFxuICAgIC8qKlxuICAgICAqIFtnZXRNdXNpYyBnZXQgbXVzaWMgdGltZV1cbiAgICAgKi9cbiAgICBnZXRNdXNpYzogZnVuY3Rpb24gZ2V0TXVzaWMoKSB7XG4gICAgICB2YXIgbV9zZWNvbmQgPSB1bmRlZmluZWQsXG4gICAgICAgICAgbV9taW51dGUgPSB1bmRlZmluZWQ7XG4gICAgICB2YXIgdGVtcF9taW51dGUgPSBwYXJzZUludCh0aGlzLiRlbHMubXBsYXllci5kdXJhdGlvbiAvIDYwKTtcbiAgICAgIGlmICh0ZW1wX21pbnV0ZS50b1N0cmluZygpLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgbV9taW51dGUgPSAnJyArIHRlbXBfbWludXRlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbV9taW51dGUgPSAnMCcgKyB0ZW1wX21pbnV0ZTtcbiAgICAgIH1cbiAgICAgIHZhciB0ZW1wX3NlY29uZCA9IHBhcnNlSW50KHRoaXMuJGVscy5tcGxheWVyLmR1cmF0aW9uICUgNjApO1xuICAgICAgaWYgKHRlbXBfc2Vjb25kLnRvU3RyaW5nKCkubGVuZ3RoID4gMSkge1xuICAgICAgICBtX3NlY29uZCA9ICcnICsgdGVtcF9zZWNvbmQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtX3NlY29uZCA9ICcwJyArIHRlbXBfc2Vjb25kO1xuICAgICAgfVxuICAgICAgdGhpcy5tdXNpY3RpbWUgPSBtX21pbnV0ZSArICc6JyArIG1fc2Vjb25kO1xuICAgIH0sXG4gICAgLyoqXG4gICAgICogW3BsYXlFdmVudCB1cGRhdGUgdGhlIHBsYXlpbmcgc3RhdHVzKHRpbWluZyDjgIFidWZmZXIuLildXG4gICAgICovXG4gICAgcGxheUV2ZW50OiBmdW5jdGlvbiBwbGF5RXZlbnQoKSB7XG4gICAgICBpZiAoIXRoaXMuY2hlY2tTdGF0dXMoKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICB2YXIgY19zZWNvbmQgPSB1bmRlZmluZWQsXG4gICAgICAgICAgY19taW51dGUgPSB1bmRlZmluZWQ7XG4gICAgICB2YXIgdGVtcF9taW51dGUgPSBwYXJzZUludCh0aGlzLiRlbHMubXBsYXllci5jdXJyZW50VGltZSAvIDYwKTtcbiAgICAgIGlmICh0ZW1wX21pbnV0ZS50b1N0cmluZygpLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgY19taW51dGUgPSAnJyArIHRlbXBfbWludXRlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY19taW51dGUgPSAnMCcgKyB0ZW1wX21pbnV0ZTtcbiAgICAgIH1cbiAgICAgIHZhciB0ZW1wX3NlY29uZCA9IHBhcnNlSW50KHRoaXMuJGVscy5tcGxheWVyLmN1cnJlbnRUaW1lICUgNjApO1xuICAgICAgaWYgKHRlbXBfc2Vjb25kLnRvU3RyaW5nKCkubGVuZ3RoID4gMSkge1xuICAgICAgICBjX3NlY29uZCA9ICcnICsgdGVtcF9zZWNvbmQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjX3NlY29uZCA9ICcwJyArIHRlbXBfc2Vjb25kO1xuICAgICAgfVxuICAgICAgdGhpcy5jdXJ0aW1lID0gY19taW51dGUgKyAnOicgKyBjX3NlY29uZDtcbiAgICAgIHZhciBwbGF5X3RpbWUgPSBNYXRoLmZsb29yKHRoaXMuJGVscy5tcGxheWVyLmN1cnJlbnRUaW1lKS50b1N0cmluZygpO1xuICAgICAgdGhpcy5kaXNwbGF5X2xyYyhwbGF5X3RpbWUpO1xuICAgICAgdmFyIGJ1ZmZlcl9wZXJjZW50ID0gdGhpcy4kZWxzLm1wbGF5ZXIuYnVmZmVyZWQuZW5kKDApIC8gdGhpcy4kZWxzLm1wbGF5ZXIuZHVyYXRpb247XG4gICAgICB2YXIgY3VycmVudF9wZXJjZW50ID0gdGhpcy4kZWxzLm1wbGF5ZXIuY3VycmVudFRpbWUgLyB0aGlzLiRlbHMubXBsYXllci5kdXJhdGlvbjtcbiAgICAgIHRoaXMuJGVscy5idWZmZXIuc3R5bGUudHJhbnNmb3JtID0gXCJzY2FsZVgoXCIgKyBidWZmZXJfcGVyY2VudCArIFwiKVwiO1xuICAgICAgdGhpcy4kZWxzLnBsYXl0aW1lLnN0eWxlLnRyYW5zZm9ybSA9IFwic2NhbGVYKFwiICsgY3VycmVudF9wZXJjZW50ICsgXCIpXCI7XG4gICAgfSxcbiAgICBjaGFuZ2VQcm9ncmVzczogZnVuY3Rpb24gY2hhbmdlUHJvZ3Jlc3MoZXZlbnQpIHtcbiAgICAgIGlmICghdGhpcy5jaGVja1N0YXR1cygpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHZhciBwcm9ncmVzc1ggPSBldmVudC5jbGllbnRYIC0gdGhpcy4kZWxzLnByb2dyZXNzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQ7XG4gICAgICB0aGlzLiRlbHMubXBsYXllci5jdXJyZW50VGltZSA9IHBhcnNlSW50KHByb2dyZXNzWCAvIDI0MCAqIHRoaXMuJGVscy5tcGxheWVyLmR1cmF0aW9uKTtcbiAgICB9LFxuICAgIGRpc3BsYXlfbHJjOiBmdW5jdGlvbiBkaXNwbGF5X2xyYyhwbGF5X3RpbWUpIHtcbiAgICAgIGlmICghdGhpcy5jaGVja1N0YXR1cygpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHZhciBscmNzID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgnbHJjJyk7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxyY3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGkgKyAxIDwgbHJjcy5sZW5ndGgpIHtcbiAgICAgICAgICBpZiAobHJjc1tpXS5nZXRBdHRyaWJ1dGUoJ2R0aW1lJykgPD0gdGhpcy4kZWxzLm1wbGF5ZXIuY3VycmVudFRpbWUgJiYgdGhpcy4kZWxzLm1wbGF5ZXIuY3VycmVudFRpbWUgPCBscmNzW2kgKyAxXS5nZXRBdHRyaWJ1dGUoJ2R0aW1lJykpIHtcbiAgICAgICAgICAgIGlmIChscmNzW2ldLmNsYXNzTGlzdCkge1xuICAgICAgICAgICAgICBscmNzW2ldLmNsYXNzTGlzdC5hZGQoJ2xyYy1jdXJyZW50Jyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBscmNzW2ldLmNsYXNzTmFtZSArPSAnICcgKyAnbHJjLWN1cnJlbnQnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGxyY3NbaV0ub2Zmc2V0VG9wID4gMjAwKSB7XG4gICAgICAgICAgICAgIHRoaXMuJGVscy5seXJpY2JveC5zY3JvbGxUb3AgPSBscmNzW2ldLm9mZnNldFRvcCAtIDIwMDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGxyY3NbaV0uY2xhc3NMaXN0KSB7XG4gICAgICAgICAgICAgIGxyY3NbaV0uY2xhc3NMaXN0LnJlbW92ZSgnbHJjLWN1cnJlbnQnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGxyY3NbaV0uY2xhc3NOYW1lID0gbHJjc1tpXS5jbGFzc05hbWUucmVwbGFjZShuZXcgUmVnRXhwKCcoXnxcXFxcYiknICsgJ2xyYy1jdXJyZW50Jy5zcGxpdCgnICcpLmpvaW4oJ3wnKSArICcoXFxcXGJ8JCknLCAnZ2knKSwgJyAnKTsgLy9pZThcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGlmIChscmNzW2xyY3MubGVuZ3RoIC0gMV0uZ2V0QXR0cmlidXRlKCdkdGltZScpIDw9IHRoaXMuJGVscy5tcGxheWVyLmN1cnJlbnRUaW1lKSB7XG4gICAgICAgIGlmIChscmNzW2xyY3MubGVuZ3RoIC0gMV0uY2xhc3NMaXN0KSB7XG4gICAgICAgICAgbHJjc1tscmNzLmxlbmd0aCAtIDFdLmNsYXNzTGlzdC5hZGQoJ2xyYy1jdXJyZW50Jyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbHJjc1tscmNzLmxlbmd0aCAtIDFdLmNsYXNzTmFtZSArPSAnICcgKyAnbHJjLWN1cnJlbnQnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
